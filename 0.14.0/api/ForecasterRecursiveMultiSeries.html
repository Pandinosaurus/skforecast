
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Python library for time series forecasting using machine learning models. It works with any regressor compatible with the scikit-learn API, including popular options like LightGBM, XGBoost, CatBoost, Keras, and many others.">
      
      
        <meta name="author" content="Joaquin Amat Rodrigo and Javier Escobar Ortiz">
      
      
        <link rel="canonical" href="https://skforecast.org/0.14.0/api/ForecasterRecursiveMultiSeries.html">
      
      
        <link rel="prev" href="ForecasterDirect.html">
      
      
        <link rel="next" href="ForecasterDirectMultiVariate.html">
      
      
      <link rel="icon" href="../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.39">
    
    
      
        <title>ForecasterRecursiveMultiSeries - Skforecast Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-GR8X9Z9LKL"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-GR8X9Z9LKL",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-GR8X9Z9LKL",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#forecasterrecursivemultiseries" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
This is documentation for an unstable development version.
  <a href="../..">
    <strong>Switch to latest stable version.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Skforecast Docs" class="md-header__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Skforecast Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ForecasterRecursiveMultiSeries
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/skforecast/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../index.html" class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-tabs__link">
        
  
    
  
  Intro to Forecasting

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../user_guides/migration-guide.html" class="md-tabs__link">
        
  
    
  
  Skforecast 0.14

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../quick-start/quick-start-skforecast.html" class="md-tabs__link">
          
  
  Quick start

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../user_guides/table-of-contents.html" class="md-tabs__link">
          
  
  User Guides

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../examples/examples_english.html" class="md-tabs__link">
          
  
  Examples and tutorials

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="ForecasterRecursive.html" class="md-tabs__link">
          
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../faq/table-of-contents.html" class="md-tabs__link">
          
  
  FAQ and Tips

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../releases/releases.html" class="md-tabs__link">
        
  
    
  
  Releases

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../authors/authors.html" class="md-tabs__link">
        
  
    
  
  Authors

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Skforecast Docs" class="md-nav__button md-logo" aria-label="Skforecast Docs" data-md-component="logo">
      
  <img src="../img/logo-skforecast.png" alt="logo">

    </a>
    Skforecast Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/skforecast/skforecast" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to skforecast
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-forecasting/introduction-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Forecasting
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/migration-guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skforecast 0.14
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Quick start
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/quick-start-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick start
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/forecaster-parameters.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/forecaster-attributes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster Attributes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/how-to-install.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to install
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guides
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            User Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/table-of-contents.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table of contents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/migration-guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skforecast 0.14 Migration guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/input-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Input data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Single series Forecasters
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Single series Forecasters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/autoregresive-forecaster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recursive multi-step forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/direct-multi-step-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Direct multi-step forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-sarimax-arima.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARIMA and SARIMAX forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-baseline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Foreasting baseline
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Global Forecasters (multiple series)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            Global Forecasters (multiple series)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/independent-multi-time-series-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Independent multi-time series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/multi-series-with-different-length-and-different_exog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Series with different lengths and different exogenous variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/dependent-multi-series-multivariate-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependent multivariate series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-with-deep-learning-rnn-lstm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep learning Recurrent Neural Networks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Feature Engineering
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Feature Engineering
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/exogenous-variables.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exogenous variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/window-features-and-custom-features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Window and custom features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/categorical-features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Categorical features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/calendar-features.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Calendars features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/sklearn-transformers-and-pipeline.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data transformation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/time-series-differentiation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Differentiation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature selection
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model Evaluation and Tuning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Model Evaluation and Tuning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/metrics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/backtesting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backtesting forecaster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/hyperparameter-tuning-and-lags-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hyperparameter tuning and lags selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/feature-selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature selection
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/probabilistic-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Probabilistic Forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/explainability.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Explainability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_10" >
        
          
          <label class="md-nav__link" for="__nav_5_10" id="__nav_5_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model deployment
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_10">
            <span class="md-nav__icon md-icon"></span>
            Model deployment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/save-load-forecaster.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Save and load forecaster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecaster-in-production.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecaster in production
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/plotting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plotting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_13" >
        
          
          <label class="md-nav__link" for="__nav_5_13" id="__nav_5_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Additional Resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_13">
            <span class="md-nav__icon md-icon"></span>
            Additional Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/training-and-prediction-matrices.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extract training and prediction matrices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/weighted-time-series-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Weighted time series forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/stacking-ensemble-models-forecasting.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stacking multiple models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/forecasting-xgboost-lightgbm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting with XGBoost and LightGBM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user_guides/skforecast-in-GPU.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skforecast in GPU
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_14" >
        
          
          <label class="md-nav__link" for="__nav_5_14" id="__nav_5_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FAQ and forecasting tips
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_14">
            <span class="md-nav__icon md-icon"></span>
            FAQ and forecasting tips
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Avoid negative predictions when forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting time series with missing values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-with-delayed-historical-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting with delayed historical data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parameters-search-backtesting-vs-one-step-ahead.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backtesting vs One-step-ahead
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/cyclical-features-time-series.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cyclical features in time series
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-aggregation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time series aggregation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parallelization-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelization in skforecast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling skforecast
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples and tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Examples and tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples_english.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    English
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/examples_spanish.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spanish
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterRecursive.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterRecursive
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterDirect.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterDirect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ForecasterRecursiveMultiSeries
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="ForecasterRecursiveMultiSeries.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ForecasterRecursiveMultiSeries
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries" class="md-nav__link">
    <span class="md-ellipsis">
      ForecasterRecursiveMultiSeries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ForecasterRecursiveMultiSeries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._repr_html_" class="md-nav__link">
    <span class="md-ellipsis">
      _repr_html_
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_lags" class="md-nav__link">
    <span class="md-ellipsis">
      _create_lags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_window_features" class="md-nav__link">
    <span class="md-ellipsis">
      _create_window_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_train_X_y_single_series" class="md-nav__link">
    <span class="md-ellipsis">
      _create_train_X_y_single_series
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_train_X_y" class="md-nav__link">
    <span class="md-ellipsis">
      _create_train_X_y
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.create_train_X_y" class="md-nav__link">
    <span class="md-ellipsis">
      create_train_X_y
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._train_test_split_one_step_ahead" class="md-nav__link">
    <span class="md-ellipsis">
      _train_test_split_one_step_ahead
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.create_sample_weights" class="md-nav__link">
    <span class="md-ellipsis">
      create_sample_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_predict_inputs" class="md-nav__link">
    <span class="md-ellipsis">
      _create_predict_inputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._recursive_predict" class="md-nav__link">
    <span class="md-ellipsis">
      _recursive_predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.create_predict_X" class="md-nav__link">
    <span class="md-ellipsis">
      create_predict_X
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_bootstrapping" class="md-nav__link">
    <span class="md-ellipsis">
      predict_bootstrapping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_interval" class="md-nav__link">
    <span class="md-ellipsis">
      predict_interval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_quantiles" class="md-nav__link">
    <span class="md-ellipsis">
      predict_quantiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_dist" class="md-nav__link">
    <span class="md-ellipsis">
      predict_dist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_params" class="md-nav__link">
    <span class="md-ellipsis">
      set_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_fit_kwargs" class="md-nav__link">
    <span class="md-ellipsis">
      set_fit_kwargs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_lags" class="md-nav__link">
    <span class="md-ellipsis">
      set_lags
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_window_features" class="md-nav__link">
    <span class="md-ellipsis">
      set_window_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_out_sample_residuals" class="md-nav__link">
    <span class="md-ellipsis">
      set_out_sample_residuals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.get_feature_importances" class="md-nav__link">
    <span class="md-ellipsis">
      get_feature_importances
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterDirectMultiVariate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterDirectMultiVariate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterRnn.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterRnn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Sarimax.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sarimax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterSarimax.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterSarimax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ForecasterEquivalentDate.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ForecasterEquivalentDate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="model_selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model_selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="feature_selection.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    feature_selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="preprocessing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    preprocessing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="metrics.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="plot.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="datasets.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="exceptions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exceptions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    FAQ and Tips
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            FAQ and Tips
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/table-of-contents.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Table of contents
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/non-negative-predictions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Avoid negative predictions when forecasting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-time-series-with-missing-values.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting time series with missing values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/forecasting-with-delayed-historical-data.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forecasting with delayed historical data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parameters-search-backtesting-vs-one-step-ahead.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backtesting vs One-step-ahead
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/cyclical-features-time-series.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cyclical features in time series
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/time-series-aggregation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time series aggregation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/parallelization-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parallelization in skforecast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/profiling-skforecast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Profiling skforecast
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../releases/releases.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Releases
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../authors/authors.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="forecasterrecursivemultiseries"><code>ForecasterRecursiveMultiSeries</code><a class="headerlink" href="#forecasterrecursivemultiseries" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-class">



<h2 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries" class="doc doc-heading">
            <span class="doc doc-object-name doc-class-name">skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">ForecasterRecursiveMultiSeries</span><span class="p">(</span>
    <span class="n">regressor</span><span class="p">,</span>
    <span class="n">lags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">window_features</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;ordinal&quot;</span><span class="p">,</span>
    <span class="n">transformer_series</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">transformer_exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">weight_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">series_weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">dropna_from_series</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">fit_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">forecaster_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="skforecast.base.ForecasterBase">ForecasterBase</span></code></p>


        <p>This class turns any regressor compatible with the scikit-learn API into a
recursive autoregressive (multi-step) forecaster for multiple series.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>regressor</code></td>
            <td>
                  <code>regressor or pipeline compatible with the scikit-learn API</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of a regressor or pipeline compatible with the scikit-learn API.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lags</code></td>
            <td>
                  <code>int, list, numpy ndarray, range</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lags used as predictors. Index starts at 1, so lag 1 is equal to t-1.</p>
<ul>
<li><code>int</code>: include lags from 1 to <code>lags</code> (included).</li>
<li><code>list</code>, <code>1d numpy ndarray</code> or <code>range</code>: include only lags present in 
<code>lags</code>, all elements must be int.</li>
<li><code>None</code>: no lags are included as predictors.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>window_features</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#object">object</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance or list of instances used to create window features. Window features
are created from the original time series and are included as predictors.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>encoding</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, None)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Encoding used to identify the different series. </p>
<ul>
<li>If <code>'ordinal'</code>, a single column is created with integer values from 0 
to n_series - 1. </li>
<li>If <code>'ordinal_category'</code>, a single column is created with integer 
values from 0 to n_series - 1 and the column is transformed into 
pandas.category dtype so that it can be used as a categorical variable. </li>
<li>If <code>'onehot'</code>, a binary column is created for each series.</li>
<li>If None, no column is created to identify the series. Internally, the
series are identified as an integer from 0 to n_series - 1, but no column
is created in the training matrices.
<strong>Changed to 'ordinal' in version 0.14.0</strong></li>
</ul>
              </div>
            </td>
            <td>
                  <code>`&#39;ordinal&#39;`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>transformer_series</code></td>
            <td>
                  <code>(transformer(preprocessor), <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of a transformer (preprocessor) compatible with the scikit-learn
preprocessing API with methods: fit, transform, fit_transform and 
inverse_transform. Transformation is applied to each <code>series</code> before training 
the forecaster. ColumnTransformers are not allowed since they do not have 
inverse_transform method.</p>
<ul>
<li>If single transformer: it is cloned and applied to all series. </li>
<li>If <code>dict</code> of transformers: a different transformer can be used for each series.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>transformer_exog</code></td>
            <td>
                  <code>transformer</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of a transformer (preprocessor) compatible with the scikit-learn
preprocessing API. The transformation is applied to <code>exog</code> before training the
forecaster. <code>inverse_transform</code> is not available when using ColumnTransformers.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>weight_func</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function that defines the individual weights for each sample based on the
index. For example, a function that assigns a lower weight to certain dates. 
Ignored if <code>regressor</code> does not have the argument <code>sample_weight</code> in its 
<code>fit</code> method. See Notes section for more details on the use of the weights.</p>
<ul>
<li>If single function: it is applied to all series. </li>
<li>If <code>dict</code> {'series_column_name' : Callable}: a different function can be
used for each series, a weight of 1 is given to all series not present in 
<code>weight_func</code>.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>series_weights</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weights associated with each series {'series_column_name' : float}. It is only
applied if the <code>regressor</code> used accepts <code>sample_weight</code> in its <code>fit</code> method. 
See Notes section for more details on the use of the weights.</p>
<ul>
<li>If a <code>dict</code> is provided, a weight of 1 is given to all series not present
in <code>series_weights</code>.</li>
<li>If <code>None</code>, all levels have the same weight.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>differentiation</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of differencing applied to the time series before training the forecaster.
If <code>None</code>, no differencing is applied. The order of differentiation is the number
of times the differencing operation is applied to a time series. Differencing
involves computing the differences between consecutive data points in the series.
Differentiation is reversed in the output of <code>predict()</code> and <code>predict_interval()</code>.
<strong>WARNING: This argument is newly introduced and requires special attention. It
is still experimental and may undergo changes.</strong></p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dropna_from_series</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Determine whether NaN detected in the training matrices will be dropped.</p>
<ul>
<li>If <code>True</code>, drop NaNs in X_train and same rows in y_train.</li>
<li>If <code>False</code>, leave NaNs in X_train and warn the user.
<strong>New in version 0.12.0</strong></li>
</ul>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fit_kwargs</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to be passed to the <code>fit</code> method of the regressor.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>forecaster_id</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name used as an identifier of the forecaster.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.regressor">regressor</span></code></td>
            <td>
                  <code>regressor or pipeline compatible with the scikit-learn API</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of a regressor or pipeline compatible with the scikit-learn API.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.lags">lags</span></code></td>
            <td>
                  <code>numpy ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lags used as predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.lags_names">lags_names</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the lags used as predictors.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.max_lag">max_lag</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum lag included in <code>lags</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.window_features">window_features</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Class or list of classes used to create window features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.window_features_names">window_features_names</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the window features to be included in the <code>X_train</code> matrix.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.window_features_class_names">window_features_class_names</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the classes used to create the window features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.max_size_window_features">max_size_window_features</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum window size required by the window features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.window_size">window_size</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The window size needed to create the predictors. It is calculated as the 
maximum value between <code>max_lag</code> and <code>max_size_window_features</code>. If 
differentiation is used, <code>window_size</code> is increased by n units equal to 
the order of differentiation so that predictors can be generated correctly.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.encoding">encoding</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Encoding used to identify the different series. </p>
<ul>
<li>If <code>'ordinal'</code>, a single column is created with integer values from 0 
to n_series - 1. </li>
<li>If <code>'ordinal_category'</code>, a single column is created with integer 
values from 0 to n_series - 1 and the column is transformed into 
pandas.category dtype so that it can be used as a categorical variable. </li>
<li>If <code>'onehot'</code>, a binary column is created for each series.</li>
<li>If None, no column is created to identify the series. Internally, the
series are identified as an integer from 0 to n_series - 1, but no column
is created in the training matrices.
<strong>Changed to 'ordinal' in version 0.14.0</strong></li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.encoder">encoder</span></code></td>
            <td>
                  <code><span title="sklearn.preprocessing">preprocessing</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scikit-learn preprocessing encoder used to encode the series.
<strong>New in version 0.12.0</strong></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.encoding_mapping_">encoding_mapping_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of the encoding used to identify the different series.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.transformer_series">transformer_series</span></code></td>
            <td>
                  <code>(transformer(preprocessor), <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of a transformer (preprocessor) compatible with the scikit-learn
preprocessing API with methods: fit, transform, fit_transform and 
inverse_transform. Transformation is applied to each <code>series</code> before training 
the forecaster. ColumnTransformers are not allowed since they do not have 
inverse_transform method.</p>
<ul>
<li>If single transformer: it is cloned and applied to all series. </li>
<li>If <code>dict</code> of transformers: a different transformer can be used for each series.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.transformer_series_">transformer_series_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with the transformer for each series. It is created cloning the 
objects in <code>transformer_series</code> and is used internally to avoid overwriting.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.transformer_exog">transformer_exog</span></code></td>
            <td>
                  <code>transformer(preprocessor)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of a transformer (preprocessor) compatible with the scikit-learn
preprocessing API. The transformation is applied to <code>exog</code> before training the
forecaster. <code>inverse_transform</code> is not available when using ColumnTransformers.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.weight_func">weight_func</span></code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" title="typing.Callable" href="https://docs.python.org/3/library/typing.html#typing.Callable">Callable</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function that defines the individual weights for each sample based on the
index. For example, a function that assigns a lower weight to certain dates. 
Ignored if <code>regressor</code> does not have the argument <code>sample_weight</code> in its 
<code>fit</code> method. See Notes section for more details on the use of the weights.</p>
<ul>
<li>If single function: it is applied to all series. </li>
<li>If <code>dict</code> {'series_column_name' : Callable}: a different function can be
used for each series, a weight of 1 is given to all series not present 
in <code>weight_func</code>.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.weight_func_">weight_func_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with the <code>weight_func</code> for each series. It is created cloning the 
objects in <code>weight_func</code> and is used internally to avoid overwriting.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.source_code_weight_func">source_code_weight_func</span></code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Source code of the custom function(s) used to create weights.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.series_weights">series_weights</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weights associated with each series {'series_column_name' : float}. It is only
applied if the <code>regressor</code> used accepts <code>sample_weight</code> in its <code>fit</code> method. 
See Notes section for more details on the use of the weights.</p>
<ul>
<li>If a <code>dict</code> is provided, a weight of 1 is given to all series not present
in <code>series_weights</code>.</li>
<li>If <code>None</code>, all levels have the same weight.</li>
</ul>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.series_weights_">series_weights_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weights associated with each series.It is created as a clone of <code>series_weights</code>
and is used internally to avoid overwriting.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.differentiation">differentiation</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Order of differencing applied to the time series before training the 
forecaster.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.differentiator">differentiator</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="skforecast.preprocessing.TimeSeriesDifferentiator" href="preprocessing.html#skforecast.preprocessing.preprocessing.TimeSeriesDifferentiator">TimeSeriesDifferentiator</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Skforecast object used to differentiate the time series.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.differentiator_">differentiator_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with the <code>differentiator</code> for each series. It is created cloning the
objects in <code>differentiator</code> and is used internally to avoid overwriting.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.dropna_from_series">dropna_from_series</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Determine whether NaN detected in the training matrices will be dropped.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.last_window_">last_window_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Last window of training data for each series. It stores the values 
needed to predict the next <code>step</code> immediately after the training data. 
These values are stored in the original scale of the time series before 
undergoing any transformations or differentiation. When <code>differentiation</code> 
parameter is specified, the dimensions of the <code>last_window_</code> are expanded 
as many values as the order of differentiation. For example, if 
<code>lags</code> = 7 and <code>differentiation</code> = 1, <code>last_window_</code> will have 8 values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.index_type_">index_type_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#type">type</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of index of the input used in training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.index_freq_">index_freq_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequency of Index of the input used in training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.training_range_">training_range_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First and last values of index of the data used during training for each 
series.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.series_names_in_">series_names_in_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the series (levels) provided by the user during training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.exog_in_">exog_in_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the forecaster has been trained using exogenous variable/s.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.exog_names_in_">exog_names_in_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the exogenous variables used during training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.exog_type_in_">exog_type_in_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#type">type</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of exogenous data (pandas Series, DataFrame or dict) used in training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.exog_dtypes_in_">exog_dtypes_in_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of each exogenous variable/s used in training. If <code>transformer_exog</code> 
is used, the dtypes are calculated before the transformation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.X_train_series_names_in_">X_train_series_names_in_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the series (levels) included in the matrix <code>X_train</code> created
internally for training. It can be different from <code>series_names_in_</code> if
some series are dropped during the training process because of NaNs or 
because they are not present in the training period.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.X_train_window_features_names_out_">X_train_window_features_names_out_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the window features included in the matrix <code>X_train</code> created
internally for training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.X_train_exog_names_out_">X_train_exog_names_out_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the exogenous variables included in the matrix <code>X_train</code> created
internally for training. It can be different from <code>exog_names_in_</code> if
some exogenous variables are transformed during the training process.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.X_train_features_names_out_">X_train_features_names_out_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of columns of the matrix created internally for training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.fit_kwargs">fit_kwargs</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to be passed to the <code>fit</code> method of the regressor.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.in_sample_residuals_">in_sample_residuals_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residuals of the model when predicting training data. Only stored up to
1000 values in the form <code>{level: residuals}</code>. If <code>transformer_series</code> 
is not <code>None</code>, residuals are stored in the transformed scale.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.out_sample_residuals_">out_sample_residuals_</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residuals of the model when predicting non-training data. Only stored
up to 1000 values in the form <code>{level: residuals}</code>. If <code>transformer_series</code> 
is not <code>None</code>, residuals are assumed to be in the transformed scale. Use 
<code>set_out_sample_residuals()</code> method to set values.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.creation_date">creation_date</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date of creation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.is_fitted">is_fitted</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tag to identify if the regressor has been fitted (trained).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.fit_date">fit_date</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Date of last fit.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.skforecast_version">skforecast_version</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Version of skforecast library used to create the forecaster.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.python_version">python_version</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Version of python used to create the forecaster.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.forecaster_id">forecaster_id</span></code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name used as an identifier of the forecaster.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>The weights are used to control the influence that each observation has on the
training of the model. <code>ForecasterRecursiveMultiSeries</code> accepts two types of weights. 
If the two types of weights are indicated, they are multiplied to create the final
weights. The resulting <code>sample_weight</code> cannot have negative values.</p>
<ul>
<li><code>series_weights</code> : controls the relative importance of each series. If a 
series has twice as much weight as the others, the observations of that series 
influence the training twice as much. The higher the weight of a series 
relative to the others, the more the model will focus on trying to learn 
that series.</li>
<li><code>weight_func</code> : controls the relative importance of each observation 
according to its index value. For example, a function that assigns a lower 
weight to certain dates.</li>
</ul>
</details>
                  <details class="quote">
                    <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
                    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">regressor</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">lags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">range</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window_features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">object</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">encoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ordinal&#39;</span><span class="p">,</span>
    <span class="n">transformer_series</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">object</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">transformer_exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">object</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">weight_func</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">series_weights</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">differentiation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dropna_from_series</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fit_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">forecaster_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span>                          <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">regressor</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span>                           <span class="o">=</span> <span class="n">encoding</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span>                            <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">encoding_mapping_</span>                  <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series</span>                 <span class="o">=</span> <span class="n">transformer_series</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span>                <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span>                   <span class="o">=</span> <span class="n">transformer_exog</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span>                        <span class="o">=</span> <span class="n">weight_func</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">weight_func_</span>                       <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">source_code_weight_func</span>            <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">series_weights</span>                     <span class="o">=</span> <span class="n">series_weights</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">series_weights_</span>                    <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>                    <span class="o">=</span> <span class="n">differentiation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span>                     <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">differentiator_</span>                    <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dropna_from_series</span>                 <span class="o">=</span> <span class="n">dropna_from_series</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span>                       <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span>                        <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span>                        <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span>                    <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">series_names_in_</span>                   <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span>                           <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span>                     <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span>                      <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span>                    <span class="o">=</span> <span class="kc">None</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_series_names_in_</span>           <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span>            <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span>        <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span>               <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>              <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span>                      <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span>                          <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span>                           <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">skforecast_version</span>                 <span class="o">=</span> <span class="n">skforecast</span><span class="o">.</span><span class="n">__version__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">python_version</span>                     <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span>                      <span class="o">=</span> <span class="n">forecaster_id</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">=</span> <span class="n">initialize_lags</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">lags</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">initialize_window_features</span><span class="p">(</span><span class="n">window_features</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;At least one of the arguments `lags` or `window_features` &quot;</span>
            <span class="s2">&quot;must be different from None. This is required to create the &quot;</span>
            <span class="s2">&quot;predictors used in training the forecaster.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
        <span class="p">[</span><span class="n">ws</span> <span class="k">for</span> <span class="n">ws</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span><span class="p">]</span> 
         <span class="k">if</span> <span class="n">ws</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">window_features_class_names</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_features_class_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span>
        <span class="p">]</span> 

    <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_code_weight_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">series_weights</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">initialize_weights</span><span class="p">(</span>
            <span class="n">forecaster_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="n">regressor</span>       <span class="o">=</span> <span class="n">regressor</span><span class="p">,</span>
            <span class="n">weight_func</span>     <span class="o">=</span> <span class="n">weight_func</span><span class="p">,</span>
            <span class="n">series_weights</span>  <span class="o">=</span> <span class="n">series_weights</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">differentiation</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">differentiation</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Argument `differentiation` must be an integer equal to or &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;greater than 1. Got </span><span class="si">{</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span> <span class="o">=</span> <span class="n">TimeSeriesDifferentiator</span><span class="p">(</span>
            <span class="n">order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span> <span class="o">=</span> <span class="n">check_select_fit_kwargs</span><span class="p">(</span>
                          <span class="n">regressor</span>  <span class="o">=</span> <span class="n">regressor</span><span class="p">,</span>
                          <span class="n">fit_kwargs</span> <span class="o">=</span> <span class="n">fit_kwargs</span>
                      <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ordinal&#39;</span><span class="p">,</span> <span class="s1">&#39;ordinal_category&#39;</span><span class="p">,</span> <span class="s1">&#39;onehot&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Argument `encoding` must be one of the following values: &#39;ordinal&#39;, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;ordinal_category&#39;, &#39;onehot&#39; or None. Got &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">==</span> <span class="s1">&#39;onehot&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span>
                           <span class="n">categories</span>    <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                           <span class="n">sparse_output</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                           <span class="n">drop</span>          <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                           <span class="n">dtype</span>         <span class="o">=</span> <span class="nb">int</span>
                       <span class="p">)</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="s1">&#39;pandas&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">(</span>
                           <span class="n">categories</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
                           <span class="n">dtype</span>      <span class="o">=</span> <span class="nb">int</span>
                       <span class="p">)</span><span class="o">.</span><span class="n">set_output</span><span class="p">(</span><span class="n">transform</span><span class="o">=</span><span class="s1">&#39;pandas&#39;</span><span class="p">)</span>

    <span class="n">scaling_regressors</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
        <span class="n">member</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">sklearn</span><span class="o">.</span><span class="n">linear_model</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">sklearn</span><span class="o">.</span><span class="n">svm</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">regressor</span><span class="p">,</span> <span class="n">scaling_regressors</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;When using a linear model, it is recommended to use a transformer_series &quot;</span>
            <span class="s2">&quot;to ensure all series are in the same scale. You can use, for example, a &quot;</span>
            <span class="s2">&quot;`StandardScaler` from sklearn.preprocessing.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;When `encoding` is None, `transformer_series` must be a single &quot;</span>
                <span class="s2">&quot;transformer (not `dict`) as it is applied to all series.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;_unknown_level&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;If `transformer_series` is a `dict`, a transformer must be &quot;</span>
                <span class="s2">&quot;provided to transform series that do not exist during training. &quot;</span>
                <span class="s2">&quot;Add the key &#39;_unknown_level&#39; to `transformer_series`. &quot;</span>
                <span class="s2">&quot;For example: {&#39;_unknown_level&#39;: your_transformer}.&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._repr_html_" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_repr_html_</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._repr_html_" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_repr_html_</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>HTML representation of the object.
The "General Information" section is expanded by default.</p>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    HTML representation of the object.</span>
<span class="sd">    The &quot;General Information&quot; section is expanded by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="p">(</span>
        <span class="n">params</span><span class="p">,</span>
        <span class="n">training_range_</span><span class="p">,</span>
        <span class="n">series_names_in_</span><span class="p">,</span>
        <span class="n">exog_names_in_</span><span class="p">,</span>
        <span class="n">transformer_series</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preprocess_repr</span><span class="p">(</span>
            <span class="n">regressor</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="p">,</span>
            <span class="n">training_range_</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span><span class="p">,</span>
            <span class="n">series_names_in_</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series_names_in_</span><span class="p">,</span>
            <span class="n">exog_names_in_</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span><span class="p">,</span>
            <span class="n">transformer_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">style</span><span class="p">,</span> <span class="n">unique_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_style_repr_html</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">)</span>

    <span class="n">content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;div class=&quot;container-</span><span class="si">{</span><span class="n">unique_id</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<span class="s2">        &lt;h2&gt;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/h2&gt;</span>
<span class="s2">        &lt;details open&gt;</span>
<span class="s2">            &lt;summary&gt;General Information&lt;/summary&gt;</span>
<span class="s2">            &lt;ul&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Regressor:&lt;/strong&gt; </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Lags:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Window features:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_features_names</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Window size:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Series encoding:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Exogenous included:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Weight function included:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Series weights:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">series_weights</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Differentiation order:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Creation date:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">creation_date</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Last fit date:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Skforecast version:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">skforecast_version</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Python version:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">python_version</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Forecaster id:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">forecaster_id</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">            &lt;/ul&gt;</span>
<span class="s2">        &lt;/details&gt;</span>
<span class="s2">        &lt;details&gt;</span>
<span class="s2">            &lt;summary&gt;Exogenous Variables&lt;/summary&gt;</span>
<span class="s2">            &lt;ul&gt;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">exog_names_in_</span><span class="si">}</span>
<span class="s2">            &lt;/ul&gt;</span>
<span class="s2">        &lt;/details&gt;</span>
<span class="s2">        &lt;details&gt;</span>
<span class="s2">            &lt;summary&gt;Data Transformations&lt;/summary&gt;</span>
<span class="s2">            &lt;ul&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Transformer for series:&lt;/strong&gt; </span><span class="si">{</span><span class="n">transformer_series</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Transformer for exog:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">            &lt;/ul&gt;</span>
<span class="s2">        &lt;/details&gt;</span>
<span class="s2">        &lt;details&gt;</span>
<span class="s2">            &lt;summary&gt;Training Information&lt;/summary&gt;</span>
<span class="s2">            &lt;ul&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Series names (levels):&lt;/strong&gt; </span><span class="si">{</span><span class="n">series_names_in_</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Training range:&lt;/strong&gt; </span><span class="si">{</span><span class="n">training_range_</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Training index type:&lt;/strong&gt; </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Not fitted&#39;</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">                &lt;li&gt;&lt;strong&gt;Training index frequency:&lt;/strong&gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Not fitted&#39;</span><span class="si">}</span><span class="s2">&lt;/li&gt;</span>
<span class="s2">            &lt;/ul&gt;</span>
<span class="s2">        &lt;/details&gt;</span>
<span class="s2">        &lt;details&gt;</span>
<span class="s2">            &lt;summary&gt;Regressor Parameters&lt;/summary&gt;</span>
<span class="s2">            &lt;ul&gt;</span>
<span class="s2">                </span><span class="si">{</span><span class="n">params</span><span class="si">}</span>
<span class="s2">            &lt;/ul&gt;</span>
<span class="s2">        &lt;/details&gt;</span>
<span class="s2">        &lt;details&gt;</span>
<span class="s2">            &lt;summary&gt;Fit Kwargs&lt;/summary&gt;</span>
<span class="s2">            &lt;ul&gt;</span>
<span class="s2">                </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="si">}</span>
<span class="s2">            &lt;/ul&gt;</span>
<span class="s2">        &lt;/details&gt;</span>
<span class="s2">        &lt;p&gt;</span>
<span class="s2">            &lt;a href=&quot;https://skforecast.org/</span><span class="si">{</span><span class="n">skforecast</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">/api/forecasterrecursivemultiseries.html&quot;&gt;&amp;#128712 &lt;strong&gt;API Reference&lt;/strong&gt;&lt;/a&gt;</span>
<span class="s2">            &amp;nbsp;&amp;nbsp;</span>
<span class="s2">            &lt;a href=&quot;https://skforecast.org/</span><span class="si">{</span><span class="n">skforecast</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">/user_guides/independent-multi-time-series-forecasting.html&quot;&gt;&amp;#128462 &lt;strong&gt;User Guide&lt;/strong&gt;&lt;/a&gt;</span>
<span class="s2">        &lt;/p&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1"># Return the combined style and content</span>
    <span class="k">return</span> <span class="n">style</span> <span class="o">+</span> <span class="n">content</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_lags" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_create_lags</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_lags" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_create_lags</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X_as_pandas</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">train_index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create the lagged values and their target variable from a time series.</p>
<p>Note that the returned matrix <code>X_data</code> contains the lag 1 in the first 
column, the lag 2 in the in the second column and so on.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>numpy ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>X_as_pandas</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the returned matrix <code>X_data</code> is a pandas DataFrame.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>train_index</code></td>
            <td>
                  <code>pandas Index</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the training data. It is used to create the pandas DataFrame
<code>X_data</code> when <code>X_as_pandas</code> is <code>True</code>.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>X_data</code></td>            <td>
                  <code>numpy ndarray, pandas DataFrame, None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lagged values (predictors).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y_data</code></td>            <td>
                  <code>numpy ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values of the time series related to each row of <code>X_data</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_create_lags</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">X_as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">train_index</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create the lagged values and their target variable from a time series.</span>

<span class="sd">    Note that the returned matrix `X_data` contains the lag 1 in the first </span>
<span class="sd">    column, the lag 2 in the in the second column and so on.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : numpy ndarray</span>
<span class="sd">        Training time series values.</span>
<span class="sd">    X_as_pandas : bool, default `False`</span>
<span class="sd">        If `True`, the returned matrix `X_data` is a pandas DataFrame.</span>
<span class="sd">    train_index : pandas Index, default `None`</span>
<span class="sd">        Index of the training data. It is used to create the pandas DataFrame</span>
<span class="sd">        `X_data` when `X_as_pandas` is `True`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X_data : numpy ndarray, pandas DataFrame, None</span>
<span class="sd">        Lagged values (predictors).</span>
<span class="sd">    y_data : numpy ndarray</span>
<span class="sd">        Values of the time series related to each row of `X_data`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">X_data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
        <span class="n">X_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">)),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">):</span>
            <span class="n">X_data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">-</span> <span class="n">lag</span><span class="p">:</span> <span class="o">-</span><span class="n">lag</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">X_as_pandas</span><span class="p">:</span>
            <span class="n">X_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                         <span class="n">data</span>    <span class="o">=</span> <span class="n">X_data</span><span class="p">,</span>
                         <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags_names</span><span class="p">,</span>
                         <span class="n">index</span>   <span class="o">=</span> <span class="n">train_index</span>
                     <span class="p">)</span>

    <span class="n">y_data</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:]</span>

    <span class="k">return</span> <span class="n">X_data</span><span class="p">,</span> <span class="n">y_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_window_features" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_create_window_features</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_window_features" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_create_window_features</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">X_as_pandas</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>train_index</code></td>
            <td>
                  <code>pandas Index</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the training data. It is used to create the pandas DataFrame
<code>X_train_window_features</code> when <code>X_as_pandas</code> is <code>True</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>X_as_pandas</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the returned matrix <code>X_train_window_features</code> is a 
pandas DataFrame.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>X_train_window_features</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of numpy ndarrays or pandas DataFrames with the window features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>X_train_window_features_names_out_</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the window features.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_create_window_features</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">train_index</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span>
    <span class="n">X_as_pandas</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    train_index : pandas Index</span>
<span class="sd">        Index of the training data. It is used to create the pandas DataFrame</span>
<span class="sd">        `X_train_window_features` when `X_as_pandas` is `True`.</span>
<span class="sd">    X_as_pandas : bool, default `False`</span>
<span class="sd">        If `True`, the returned matrix `X_train_window_features` is a </span>
<span class="sd">        pandas DataFrame.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X_train_window_features : list</span>
<span class="sd">        List of numpy ndarrays or pandas DataFrames with the window features.</span>
<span class="sd">    X_train_window_features_names_out_ : list</span>
<span class="sd">        Names of the window features.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">len_train_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_index</span><span class="p">)</span>
    <span class="n">X_train_window_features</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span><span class="p">:</span>
        <span class="n">X_train_wf</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">transform_batch</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X_train_wf</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The method `transform_batch` of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;must return a pandas DataFrame.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="n">X_train_wf</span> <span class="o">=</span> <span class="n">X_train_wf</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="n">len_train_index</span><span class="p">:]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train_wf</span><span class="p">)</span> <span class="o">==</span> <span class="n">len_train_index</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The method `transform_batch` of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;must return a DataFrame with the same number of rows as &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;the input time series - `window_size`: </span><span class="si">{</span><span class="n">len_train_index</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">X_train_wf</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">train_index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The method `transform_batch` of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;must return a DataFrame with the same index as &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;the input time series - `window_size`.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">X_train_window_features_names_out_</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">X_train_wf</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">X_as_pandas</span><span class="p">:</span>
            <span class="n">X_train_wf</span> <span class="o">=</span> <span class="n">X_train_wf</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>     
        <span class="n">X_train_window_features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_train_wf</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_train_window_features</span><span class="p">,</span> <span class="n">X_train_window_features_names_out_</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_train_X_y_single_series" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_create_train_X_y_single_series</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_train_X_y_single_series" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_create_train_X_y_single_series</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ignore_exog</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create training matrices from univariate time series and exogenous
variables. This method does not transform the exog variables.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>y</code></td>
            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>ignore_exog</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, <code>exog</code> is ignored.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>X_train_lags</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training values of lags.
Shape: (len(y) - self.max_lag, len(self.lags))</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>X_train_window_features_names_out_</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the window features.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>X_train_exog</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training values of exogenous variables.
Shape: (len(y) - self.max_lag, len(exog.columns))</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y_train</code></td>            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values (target) of the time series related to each row of <code>X_train</code>.
Shape: (len(y) - self.max_lag, )</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_create_train_X_y_single_series</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">ignore_exog</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create training matrices from univariate time series and exogenous</span>
<span class="sd">    variables. This method does not transform the exog variables.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : pandas Series</span>
<span class="sd">        Training time series.</span>
<span class="sd">    ignore_exog : bool</span>
<span class="sd">        If `True`, `exog` is ignored.</span>
<span class="sd">    exog : pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X_train_lags : pandas DataFrame</span>
<span class="sd">        Training values of lags.</span>
<span class="sd">        Shape: (len(y) - self.max_lag, len(self.lags))</span>
<span class="sd">    X_train_window_features_names_out_ : list</span>
<span class="sd">        Names of the window features.</span>
<span class="sd">    X_train_exog : pandas DataFrame</span>
<span class="sd">        Training values of exogenous variables.</span>
<span class="sd">        Shape: (len(y) - self.max_lag, len(exog.columns))</span>
<span class="sd">    y_train : pandas Series</span>
<span class="sd">        Values (target) of the time series related to each row of `X_train`.</span>
<span class="sd">        Shape: (len(y) - self.max_lag, )</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">series_name</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">name</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Length of &#39;</span><span class="si">{</span><span class="n">series_name</span><span class="si">}</span><span class="s2">&#39; must be greater than the maximum window size &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;needed by the forecaster.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;    Length &#39;</span><span class="si">{</span><span class="n">series_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;    Max window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;    Lags window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;    Window features window size: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fit_transformer</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">transformer_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fit_transformer</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="n">transformer_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="p">[</span><span class="n">series_name</span><span class="p">]</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">transform_series</span><span class="p">(</span>
            <span class="n">series</span>            <span class="o">=</span> <span class="n">y</span><span class="p">,</span>
            <span class="n">transformer</span>       <span class="o">=</span> <span class="n">transformer_series</span><span class="p">,</span>
            <span class="n">fit</span>               <span class="o">=</span> <span class="n">fit_transformer</span><span class="p">,</span>
            <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="p">)</span>

    <span class="n">y_values</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="n">y_index</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">index</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
            <span class="n">y_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator_</span><span class="p">[</span><span class="n">series_name</span><span class="p">]</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">differentiator</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiator_</span><span class="p">[</span><span class="n">series_name</span><span class="p">])</span>
            <span class="n">y_values</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_values</span><span class="p">)</span>

    <span class="n">X_train_autoreg</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">train_index</span> <span class="o">=</span> <span class="n">y_index</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:]</span>

    <span class="n">X_train_lags</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_lags</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="n">y_values</span><span class="p">,</span> <span class="n">X_as_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">train_index</span><span class="o">=</span><span class="n">train_index</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">X_train_lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">X_train_autoreg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_train_lags</span><span class="p">)</span>

    <span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">n_diff</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>
        <span class="n">y_window_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_values</span><span class="p">[</span><span class="n">n_diff</span><span class="p">:],</span> <span class="n">index</span><span class="o">=</span><span class="n">y_index</span><span class="p">[</span><span class="n">n_diff</span><span class="p">:])</span>
        <span class="n">X_train_window_features</span><span class="p">,</span> <span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_window_features</span><span class="p">(</span>
                <span class="n">y</span><span class="o">=</span><span class="n">y_window_features</span><span class="p">,</span> <span class="n">X_as_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">train_index</span><span class="o">=</span><span class="n">train_index</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">X_train_autoreg</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">X_train_window_features</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train_autoreg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">X_train_autoreg</span> <span class="o">=</span> <span class="n">X_train_autoreg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X_train_autoreg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">X_train_autoreg</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">X_train_autoreg</span><span class="p">[</span><span class="s1">&#39;_level_skforecast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">series_name</span>

    <span class="k">if</span> <span class="n">ignore_exog</span><span class="p">:</span>
        <span class="n">X_train_exog</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># The first `self.window_size` positions have to be removed from exog</span>
            <span class="c1"># since they are not in X_train_autoreg.</span>
            <span class="n">X_train_exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:,</span> <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_train_exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                               <span class="n">data</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                               <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_dummy_exog_col_to_keep_shape&#39;</span><span class="p">],</span>
                               <span class="n">index</span>   <span class="o">=</span> <span class="n">train_index</span>
                           <span class="p">)</span>

    <span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
                  <span class="n">data</span>  <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span>
                  <span class="n">index</span> <span class="o">=</span> <span class="n">train_index</span><span class="p">,</span>
                  <span class="n">name</span>  <span class="o">=</span> <span class="s1">&#39;y&#39;</span>
              <span class="p">)</span>

    <span class="k">return</span> <span class="n">X_train_autoreg</span><span class="p">,</span> <span class="n">X_train_window_features_names_out_</span><span class="p">,</span> <span class="n">X_train_exog</span><span class="p">,</span> <span class="n">y_train</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_train_X_y" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_create_train_X_y</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_train_X_y" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_create_train_X_y</span><span class="p">(</span>
    <span class="n">series</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">store_last_window</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create training matrices from multiple time series and exogenous
variables. See Notes section for more details depending on the type of
<code>series</code> and <code>exog</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>series</code></td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>store_last_window</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to store the last window (<code>last_window_</code>) of training data.</p>
<ul>
<li>If <code>True</code>, last window is stored for all series. </li>
<li>If <code>list</code>, last window is stored for the series present in the list.</li>
<li>If <code>False</code>, last window is not stored.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>X_train</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training values (predictors).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y_train</code></td>            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values of the time series related to each row of <code>X_train</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>series_indexes</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with the index of each series.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>series_names_in_</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the series (levels) provided by the user during training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>X_train_series_names_in_</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the series (levels) included in the matrix <code>X_train</code> created
internally for training. It can be different from <code>series_names_in_</code> if
some series are dropped during the training process because of NaNs or
because they are not present in the training period.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>exog_names_in_</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the exogenous variables used during training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>X_train_window_features_names_out_</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the window features included in the matrix <code>X_train</code> created
internally for training.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>X_train_exog_names_out_</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the exogenous variables included in the matrix <code>X_train</code> created
internally for training. It can be different from <code>exog_names_in_</code> if
some exogenous variables are transformed during the training process.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>exog_dtypes_in_</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of each exogenous variable/s used in training. If <code>transformer_exog</code> 
is used, the dtypes are calculated before the transformation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>last_window_</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Last window of training data for each series. It stores the values 
needed to predict the next <code>step</code> immediately after the training data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>If <code>series</code> is a pandas DataFrame and <code>exog</code> is a pandas Series or 
DataFrame, each exog is duplicated for each series. Exog must have the
same index as <code>series</code> (type, length and frequency).</li>
<li>If <code>series</code> is a pandas DataFrame and <code>exog</code> is a dict of pandas Series 
or DataFrames. Each key in <code>exog</code> must be a column in <code>series</code> and the 
values are the exog for each series. Exog must have the same index as 
<code>series</code> (type, length and frequency).</li>
<li>If <code>series</code> is a dict of pandas Series, <code>exog</code> must be a dict of pandas
Series or DataFrames. The keys in <code>series</code> and <code>exog</code> must be the same.
All series and exog must have a pandas DatetimeIndex with the same 
frequency.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_create_train_X_y</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">store_last_window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create training matrices from multiple time series and exogenous</span>
<span class="sd">    variables. See Notes section for more details depending on the type of</span>
<span class="sd">    `series` and `exog`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    store_last_window : bool, list, default `True`</span>
<span class="sd">        Whether or not to store the last window (`last_window_`) of training data.</span>

<span class="sd">        - If `True`, last window is stored for all series. </span>
<span class="sd">        - If `list`, last window is stored for the series present in the list.</span>
<span class="sd">        - If `False`, last window is not stored.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X_train : pandas DataFrame</span>
<span class="sd">        Training values (predictors).</span>
<span class="sd">    y_train : pandas Series</span>
<span class="sd">        Values of the time series related to each row of `X_train`.</span>
<span class="sd">    series_indexes : dict</span>
<span class="sd">        Dictionary with the index of each series.</span>
<span class="sd">    series_names_in_ : list</span>
<span class="sd">        Names of the series (levels) provided by the user during training.</span>
<span class="sd">    X_train_series_names_in_ : list</span>
<span class="sd">        Names of the series (levels) included in the matrix `X_train` created</span>
<span class="sd">        internally for training. It can be different from `series_names_in_` if</span>
<span class="sd">        some series are dropped during the training process because of NaNs or</span>
<span class="sd">        because they are not present in the training period.</span>
<span class="sd">    exog_names_in_ : list</span>
<span class="sd">        Names of the exogenous variables used during training.</span>
<span class="sd">    X_train_window_features_names_out_ : list</span>
<span class="sd">        Names of the window features included in the matrix `X_train` created</span>
<span class="sd">        internally for training.</span>
<span class="sd">    X_train_exog_names_out_ : list</span>
<span class="sd">        Names of the exogenous variables included in the matrix `X_train` created</span>
<span class="sd">        internally for training. It can be different from `exog_names_in_` if</span>
<span class="sd">        some exogenous variables are transformed during the training process.</span>
<span class="sd">    exog_dtypes_in_ : dict</span>
<span class="sd">        Type of each exogenous variable/s used in training. If `transformer_exog` </span>
<span class="sd">        is used, the dtypes are calculated before the transformation.</span>
<span class="sd">    last_window_ : dict</span>
<span class="sd">        Last window of training data for each series. It stores the values </span>
<span class="sd">        needed to predict the next `step` immediately after the training data.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - If `series` is a pandas DataFrame and `exog` is a pandas Series or </span>
<span class="sd">    DataFrame, each exog is duplicated for each series. Exog must have the</span>
<span class="sd">    same index as `series` (type, length and frequency).</span>
<span class="sd">    - If `series` is a pandas DataFrame and `exog` is a dict of pandas Series </span>
<span class="sd">    or DataFrames. Each key in `exog` must be a column in `series` and the </span>
<span class="sd">    values are the exog for each series. Exog must have the same index as </span>
<span class="sd">    `series` (type, length and frequency).</span>
<span class="sd">    - If `series` is a dict of pandas Series, `exog` must be a dict of pandas</span>
<span class="sd">    Series or DataFrames. The keys in `series` and `exog` must be the same.</span>
<span class="sd">    All series and exog must have a pandas DatetimeIndex with the same </span>
<span class="sd">    frequency.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">series_dict</span><span class="p">,</span> <span class="n">series_indexes</span> <span class="o">=</span> <span class="n">check_preprocess_series</span><span class="p">(</span><span class="n">series</span><span class="o">=</span><span class="n">series</span><span class="p">)</span>
    <span class="n">input_series_is_dict</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
    <span class="n">series_names_in_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">series_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">series_names_in_</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names_in_</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Once the Forecaster has been trained, `series` must contain &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;the same series names as those used during training:</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot; Got      : </span><span class="si">{</span><span class="n">series_names_in_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
             <span class="sa">f</span><span class="s2">&quot; Expected : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">series_names_in_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">exog_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">serie</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_names_in_</span><span class="p">}</span>
    <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">exog_dict</span><span class="p">,</span> <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">check_preprocess_exog_multiseries</span><span class="p">(</span>
                                        <span class="n">input_series_is_dict</span> <span class="o">=</span> <span class="n">input_series_is_dict</span><span class="p">,</span>
                                        <span class="n">series_indexes</span>       <span class="o">=</span> <span class="n">series_indexes</span><span class="p">,</span>
                                        <span class="n">series_names_in_</span>     <span class="o">=</span> <span class="n">series_names_in_</span><span class="p">,</span>
                                        <span class="n">exog</span>                 <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                                        <span class="n">exog_dict</span>            <span class="o">=</span> <span class="n">exog_dict</span>
                                    <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="s2">&quot;Once the Forecaster has been trained, `exog` must be `None` &quot;</span>
                     <span class="s2">&quot;because no exogenous variables were added during training.&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">exog_names_in_</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Once the Forecaster has been trained, `exog` must contain &quot;</span>
                         <span class="sa">f</span><span class="s2">&quot;the same exogenous variables as those used during training:</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="sa">f</span><span class="s2">&quot; Got      : </span><span class="si">{</span><span class="n">exog_names_in_</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="sa">f</span><span class="s2">&quot; Expected : </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span> <span class="o">=</span> <span class="n">initialize_transformer_series</span><span class="p">(</span>
                                       <span class="n">forecaster_name</span>    <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                                       <span class="n">series_names_in_</span>   <span class="o">=</span> <span class="n">series_names_in_</span><span class="p">,</span>
                                       <span class="n">encoding</span>           <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
                                       <span class="n">transformer_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series</span>
                                   <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">differentiator_</span> <span class="o">=</span> <span class="p">{</span><span class="n">serie</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_names_in_</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">differentiator_</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">serie</span><span class="p">:</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="p">)</span> <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_names_in_</span>
            <span class="p">}</span>

    <span class="n">series_dict</span><span class="p">,</span> <span class="n">exog_dict</span> <span class="o">=</span> <span class="n">align_series_and_exog_multiseries</span><span class="p">(</span>
                                 <span class="n">series_dict</span>          <span class="o">=</span> <span class="n">series_dict</span><span class="p">,</span>
                                 <span class="n">input_series_is_dict</span> <span class="o">=</span> <span class="n">input_series_is_dict</span><span class="p">,</span>
                                 <span class="n">exog_dict</span>            <span class="o">=</span> <span class="n">exog_dict</span>
                             <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">series_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">ignore_exog</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>
    <span class="n">input_matrices</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="n">series_dict</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">exog_dict</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">ignore_exog</span><span class="p">]</span>
         <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">series_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="p">]</span>

    <span class="n">X_train_autoreg_buffer</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">X_train_exog_buffer</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_train_buffer</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">matrices</span> <span class="ow">in</span> <span class="n">input_matrices</span><span class="p">:</span>

        <span class="p">(</span>
            <span class="n">X_train_autoreg</span><span class="p">,</span>
            <span class="n">X_train_window_features_names_out_</span><span class="p">,</span>
            <span class="n">X_train_exog</span><span class="p">,</span>
            <span class="n">y_train</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y_single_series</span><span class="p">(</span>
            <span class="n">y</span>           <span class="o">=</span> <span class="n">matrices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">exog</span>        <span class="o">=</span> <span class="n">matrices</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">ignore_exog</span> <span class="o">=</span> <span class="n">matrices</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">X_train_autoreg_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_train_autoreg</span><span class="p">)</span>
        <span class="n">X_train_exog_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_train_exog</span><span class="p">)</span>
        <span class="n">y_train_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>

    <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">X_train_autoreg_buffer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">y_train_buffer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
        <span class="n">encoded_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[[</span><span class="s1">&#39;_level_skforecast&#39;</span><span class="p">]])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">encoded_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[[</span><span class="s1">&#39;_level_skforecast&#39;</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">code</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">categories_</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">encoding_mapping_</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

    <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
                  <span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;_level_skforecast&#39;</span><span class="p">),</span>
                  <span class="n">encoded_values</span>
              <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">==</span> <span class="s1">&#39;onehot&#39;</span><span class="p">:</span>
        <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_level_skforecast_&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">==</span> <span class="s1">&#39;ordinal_category&#39;</span><span class="p">:</span>
        <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;_level_skforecast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;_level_skforecast&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">del</span> <span class="n">encoded_values</span>

    <span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">X_train_exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">X_train_exog_buffer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;_dummy_exog_col_to_keep_shape&#39;</span> <span class="ow">in</span> <span class="n">X_train_exog</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">X_train_exog</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">X_train_exog</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_dummy_exog_col_to_keep_shape&#39;</span><span class="p">])</span>
            <span class="p">)</span>

        <span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">X_train_exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="n">get_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">X_train_exog</span><span class="p">)</span>

        <span class="n">fit_transformer</span> <span class="o">=</span> <span class="kc">False</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="k">else</span> <span class="kc">True</span>
        <span class="n">X_train_exog</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
                           <span class="n">df</span>                <span class="o">=</span> <span class="n">X_train_exog</span><span class="p">,</span>
                           <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
                           <span class="n">fit</span>               <span class="o">=</span> <span class="n">fit_transformer</span><span class="p">,</span>
                           <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                       <span class="p">)</span>

        <span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">X_train_exog</span><span class="p">,</span> <span class="n">call_check_exog</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">X_train_exog</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;Different index for `series` and `exog` after transformation. &quot;</span>
                 <span class="s2">&quot;They must be equal to ensure the correct alignment of values.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="n">X_train_exog</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_train_exog</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">y_train</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">mask</span><span class="p">,]</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;NaNs detected in `y_train`. They have been dropped because the &quot;</span>
             <span class="s2">&quot;target variable cannot have NaN values. Same rows have been &quot;</span>
             <span class="s2">&quot;dropped from `X_train` to maintain alignment. This is caused by &quot;</span>
             <span class="s2">&quot;series with interspersed NaNs.&quot;</span><span class="p">),</span>
             <span class="n">MissingValuesWarning</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropna_from_series</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()):</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">mask</span><span class="p">,</span> <span class="p">]</span>
            <span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;NaNs detected in `X_train`. They have been dropped. If &quot;</span>
                 <span class="s2">&quot;you want to keep them, set `forecaster.dropna_from_series = False`. &quot;</span>
                 <span class="s2">&quot;Same rows have been removed from `y_train` to maintain alignment. &quot;</span>
                 <span class="s2">&quot;This caused by series with interspersed NaNs.&quot;</span><span class="p">),</span>
                 <span class="n">MissingValuesWarning</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;NaNs detected in `X_train`. Some regressors do not allow &quot;</span>
                 <span class="s2">&quot;NaN values during training. If you want to drop them, &quot;</span>
                 <span class="s2">&quot;set `forecaster.dropna_from_series = True`.&quot;</span><span class="p">),</span>
                 <span class="n">MissingValuesWarning</span>
            <span class="p">)</span>

    <span class="k">if</span> <span class="n">X_train</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;All samples have been removed due to NaNs. Set &quot;</span>
             <span class="s2">&quot;`forecaster.dropna_from_series = False` or review `exog` values.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">==</span> <span class="s1">&#39;onehot&#39;</span><span class="p">:</span>
        <span class="n">X_train_series_names_in_</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">series_names_in_</span> <span class="k">if</span> <span class="n">X_train</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">unique_levels</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;_level_skforecast&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
        <span class="n">X_train_series_names_in_</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_mapping_</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">unique_levels</span>
        <span class="p">]</span>

    <span class="c1"># The last time window of training data is stored so that lags needed as</span>
    <span class="c1"># predictors in the first iteration of `predict()` can be calculated.</span>
    <span class="n">last_window_</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">store_last_window</span><span class="p">:</span>

        <span class="n">series_to_store</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">X_train_series_names_in_</span> <span class="k">if</span> <span class="n">store_last_window</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">store_last_window</span>
        <span class="p">)</span>

        <span class="n">series_not_in_series_dict</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">series_to_store</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">X_train_series_names_in_</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">series_not_in_series_dict</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Series </span><span class="si">{</span><span class="n">series_not_in_series_dict</span><span class="si">}</span><span class="s2"> are not present in &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;`series`. No last window is stored for them.&quot;</span><span class="p">),</span>
                <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>
            <span class="n">series_to_store</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">series_to_store</span> 
                               <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">series_not_in_series_dict</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">series_to_store</span><span class="p">:</span>
            <span class="n">last_window_</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">series_to_store</span>
            <span class="p">}</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">X_train</span><span class="p">,</span>
        <span class="n">y_train</span><span class="p">,</span>
        <span class="n">series_indexes</span><span class="p">,</span>
        <span class="n">series_names_in_</span><span class="p">,</span>
        <span class="n">X_train_series_names_in_</span><span class="p">,</span>
        <span class="n">exog_names_in_</span><span class="p">,</span>
        <span class="n">X_train_window_features_names_out_</span><span class="p">,</span>
        <span class="n">X_train_exog_names_out_</span><span class="p">,</span>
        <span class="n">exog_dtypes_in_</span><span class="p">,</span>
        <span class="n">last_window_</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.create_train_X_y" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_train_X_y</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.create_train_X_y" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">create_train_X_y</span><span class="p">(</span>
    <span class="n">series</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create training matrices from multiple time series and exogenous
variables. See Notes section for more details depending on the type of
<code>series</code> and <code>exog</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>series</code></td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the creation
of the training matrices. See skforecast.exceptions.warn_skforecast_categories 
for more information.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>X_train</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training values (predictors).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y_train</code></td>            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values (target) of the time series related to each row of <code>X_train</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>If <code>series</code> is a pandas DataFrame and <code>exog</code> is a pandas Series or 
DataFrame, each exog is duplicated for each series. Exog must have the
same index as <code>series</code> (type, length and frequency).</li>
<li>If <code>series</code> is a pandas DataFrame and <code>exog</code> is a dict of pandas Series 
or DataFrames. Each key in <code>exog</code> must be a column in <code>series</code> and the 
values are the exog for each series. Exog must have the same index as 
<code>series</code> (type, length and frequency).</li>
<li>If <code>series</code> is a dict of pandas Series, <code>exog</code>must be a dict of pandas
Series or DataFrames. The keys in <code>series</code> and <code>exog</code> must be the same.
All series and exog must have a pandas DatetimeIndex with the same 
frequency.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_train_X_y</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create training matrices from multiple time series and exogenous</span>
<span class="sd">    variables. See Notes section for more details depending on the type of</span>
<span class="sd">    `series` and `exog`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    suppress_warnings : bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the creation</span>
<span class="sd">        of the training matrices. See skforecast.exceptions.warn_skforecast_categories </span>
<span class="sd">        for more information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X_train : pandas DataFrame</span>
<span class="sd">        Training values (predictors).</span>
<span class="sd">    y_train : pandas Series</span>
<span class="sd">        Values (target) of the time series related to each row of `X_train`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - If `series` is a pandas DataFrame and `exog` is a pandas Series or </span>
<span class="sd">    DataFrame, each exog is duplicated for each series. Exog must have the</span>
<span class="sd">    same index as `series` (type, length and frequency).</span>
<span class="sd">    - If `series` is a pandas DataFrame and `exog` is a dict of pandas Series </span>
<span class="sd">    or DataFrames. Each key in `exog` must be a column in `series` and the </span>
<span class="sd">    values are the exog for each series. Exog must have the same index as </span>
<span class="sd">    `series` (type, length and frequency).</span>
<span class="sd">    - If `series` is a dict of pandas Series, `exog`must be a dict of pandas</span>
<span class="sd">    Series or DataFrames. The keys in `series` and `exog` must be the same.</span>
<span class="sd">    All series and exog must have a pandas DatetimeIndex with the same </span>
<span class="sd">    frequency.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span>
                 <span class="n">series</span>            <span class="o">=</span> <span class="n">series</span><span class="p">,</span> 
                 <span class="n">exog</span>              <span class="o">=</span> <span class="n">exog</span><span class="p">,</span> 
                 <span class="n">store_last_window</span> <span class="o">=</span> <span class="kc">False</span>
             <span class="p">)</span>

    <span class="n">X_train</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;_level_skforecast&#39;</span><span class="p">)</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._train_test_split_one_step_ahead" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_train_test_split_one_step_ahead</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._train_test_split_one_step_ahead" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_train_test_split_one_step_ahead</span><span class="p">(</span>
    <span class="n">series</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create matrices needed to train and test the forecaster for one-step-ahead
predictions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>series</code></td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>initial_train_size</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial size of the training set. It is the number of observations used
to train the forecaster before making the first prediction.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>X_train</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predictor values used to train the model.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y_train</code></td>            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target values related to each row of <code>X_train</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>X_test</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predictor values used to test the model.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>y_test</code></td>            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target values related to each row of <code>X_test</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>X_train_encoding</code></td>            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series identifiers for each row of <code>X_train</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>X_test_encoding</code></td>            <td>
                  <code>pandas Series</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series identifiers for each row of <code>X_test</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_train_test_split_one_step_ahead</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">initial_train_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create matrices needed to train and test the forecaster for one-step-ahead</span>
<span class="sd">    predictions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    initial_train_size : int</span>
<span class="sd">        Initial size of the training set. It is the number of observations used</span>
<span class="sd">        to train the forecaster before making the first prediction.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X_train : pandas DataFrame</span>
<span class="sd">        Predictor values used to train the model.</span>
<span class="sd">    y_train : pandas Series</span>
<span class="sd">        Target values related to each row of `X_train`.</span>
<span class="sd">    X_test : pandas DataFrame</span>
<span class="sd">        Predictor values used to test the model.</span>
<span class="sd">    y_test : pandas Series</span>
<span class="sd">        Target values related to each row of `X_test`.</span>
<span class="sd">    X_train_encoding : pandas Series</span>
<span class="sd">        Series identifiers for each row of `X_train`.</span>
<span class="sd">    X_test_encoding : pandas Series</span>
<span class="sd">        Series identifiers for each row of `X_test`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">freqs</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">freqs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least one series must have a frequency.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">f</span> <span class="o">==</span> <span class="n">freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">freqs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;All series with frequency must have the same frequency.&quot;</span>
            <span class="p">)</span>
        <span class="n">min_index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
        <span class="n">max_index</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">v</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
        <span class="n">span_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">min_index</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">max_index</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">span_index</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">index</span>

    <span class="n">fold</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">],</span>
        <span class="p">[</span><span class="n">initial_train_size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span> <span class="n">initial_train_size</span><span class="p">],</span>
        <span class="p">[</span><span class="n">initial_train_size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">span_index</span><span class="p">)],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># Dummy value</span>
        <span class="kc">True</span>
    <span class="p">]</span>
    <span class="n">data_fold</span> <span class="o">=</span> <span class="n">_extract_data_folds_multiseries</span><span class="p">(</span>
                    <span class="n">series</span>             <span class="o">=</span> <span class="n">series</span><span class="p">,</span>
                    <span class="n">folds</span>              <span class="o">=</span> <span class="p">[</span><span class="n">fold</span><span class="p">],</span>
                    <span class="n">span_index</span>         <span class="o">=</span> <span class="n">span_index</span><span class="p">,</span>
                    <span class="n">window_size</span>        <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span>
                    <span class="n">exog</span>               <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                    <span class="n">dropna_last_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dropna_from_series</span><span class="p">,</span>
                    <span class="n">externally_fitted</span>  <span class="o">=</span> <span class="kc">False</span>
                <span class="p">)</span>
    <span class="n">series_train</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">levels_last_window</span><span class="p">,</span> <span class="n">exog_train</span><span class="p">,</span> <span class="n">exog_test</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">data_fold</span><span class="p">)</span>

    <span class="n">start_test_idx</span> <span class="o">=</span> <span class="n">initial_train_size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">series_test</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">start_test_idx</span><span class="p">:,</span> <span class="p">:]</span>
        <span class="n">series_test</span> <span class="o">=</span> <span class="n">series_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">levels_last_window</span><span class="p">]</span>
        <span class="n">series_test</span> <span class="o">=</span> <span class="n">series_test</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">start_test_date</span> <span class="o">=</span> <span class="n">span_index</span><span class="p">[</span><span class="n">start_test_idx</span><span class="p">]</span>
        <span class="n">series_test</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="n">start_test_date</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">levels_last_window</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">empty</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="n">_is_fitted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span>
    <span class="n">_series_names_in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series_names_in_</span>
    <span class="n">_exog_names_in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">series_names_in_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">exog_names_in_</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span>
            <span class="n">series</span>            <span class="o">=</span> <span class="n">series_train</span><span class="p">,</span>
            <span class="n">exog</span>              <span class="o">=</span> <span class="n">exog_train</span><span class="p">,</span>
            <span class="n">store_last_window</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">series_names_in_</span> <span class="o">=</span> <span class="n">series_names_in_</span>
    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">exog_names_in_</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span>
                             <span class="n">series</span>            <span class="o">=</span> <span class="n">series_test</span><span class="p">,</span>
                             <span class="n">exog</span>              <span class="o">=</span> <span class="n">exog_test</span><span class="p">,</span>
                             <span class="n">store_last_window</span> <span class="o">=</span> <span class="kc">False</span>
                         <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="n">_is_fitted</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">series_names_in_</span> <span class="o">=</span> <span class="n">_series_names_in_</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">_exog_names_in_</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ordinal&quot;</span><span class="p">,</span> <span class="s2">&quot;ordinal_category&quot;</span><span class="p">]:</span>
        <span class="n">X_train_encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
            <span class="n">X_train</span><span class="p">[[</span><span class="s2">&quot;_level_skforecast&quot;</span><span class="p">]]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">X_test_encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
            <span class="n">X_test</span><span class="p">[[</span><span class="s2">&quot;_level_skforecast&quot;</span><span class="p">]]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">==</span> <span class="s1">&#39;onehot&#39;</span><span class="p">:</span>
        <span class="n">X_train_encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
            <span class="n">X_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_mapping_</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">X_test_encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
            <span class="n">X_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_mapping_</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X_train_encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
            <span class="n">X_train</span><span class="p">[[</span><span class="s2">&quot;_level_skforecast&quot;</span><span class="p">]]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">X_test_encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span>
            <span class="n">X_test</span><span class="p">[[</span><span class="s2">&quot;_level_skforecast&quot;</span><span class="p">]]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;_level_skforecast&quot;</span><span class="p">)</span>
        <span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;_level_skforecast&quot;</span><span class="p">)</span>

    <span class="n">X_train_encoding</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">X_train_encoding</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">index</span>
    <span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;_unknown_level&quot;</span><span class="p">)</span>
    <span class="n">X_test_encoding</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">X_test_encoding</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X_test</span><span class="o">.</span><span class="n">index</span>
    <span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;_unknown_level&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">X_train_encoding</span><span class="p">,</span> <span class="n">X_test_encoding</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.create_sample_weights" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_sample_weights</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.create_sample_weights" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">create_sample_weights</span><span class="p">(</span><span class="n">series_names_in_</span><span class="p">,</span> <span class="n">X_train</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Crate weights for each observation according to the forecaster's attributes
<code>series_weights</code> and <code>weight_func</code>. The resulting weights are product of both
types of weights.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>series_names_in_</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the series (levels) used during training.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>X_train</code></td>
            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dataframe created with the <code>create_train_X_y</code> method, first return.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>weights</code></td>            <td>
                  <code>numpy ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Weights to use in <code>fit</code> method.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_sample_weights</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">series_names_in_</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">X_train</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Crate weights for each observation according to the forecaster&#39;s attributes</span>
<span class="sd">    `series_weights` and `weight_func`. The resulting weights are product of both</span>
<span class="sd">    types of weights.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    series_names_in_ : list</span>
<span class="sd">        Names of the series (levels) used during training.</span>
<span class="sd">    X_train : pandas DataFrame</span>
<span class="sd">        Dataframe created with the `create_train_X_y` method, first return.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    weights : numpy ndarray</span>
<span class="sd">        Weights to use in `fit` method.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">weights</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">weights_samples</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">weights_series</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">series_weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Series not present in series_weights have a weight of 1 in all their samples.</span>
        <span class="c1"># Keys in series_weights not present in series are ignored.</span>
        <span class="n">series_not_in_series_weights</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">set</span><span class="p">(</span><span class="n">series_names_in_</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">series_weights</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">series_not_in_series_weights</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_not_in_series_weights</span><span class="si">}</span><span class="s2"> not present in `series_weights`. &quot;</span>
                 <span class="sa">f</span><span class="s2">&quot;A weight of 1 is given to all their samples.&quot;</span><span class="p">),</span>
                 <span class="n">IgnoredArgumentWarning</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">series_weights_</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="mf">1.</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">series_names_in_</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">series_weights_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
            <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">series_weights</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">series_weights_</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">==</span> <span class="s2">&quot;onehot&quot;</span><span class="p">:</span>
            <span class="n">weights_series</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">series_weights_</span><span class="p">[</span><span class="n">serie</span><span class="p">],</span> <span class="nb">sum</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">serie</span><span class="p">]))</span>
                <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_names_in_</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">weights_series</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">series_weights_</span><span class="p">[</span><span class="n">serie</span><span class="p">],</span>
                    <span class="nb">sum</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="s2">&quot;_level_skforecast&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_mapping_</span><span class="p">[</span><span class="n">serie</span><span class="p">]),</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">serie</span> <span class="ow">in</span> <span class="n">series_names_in_</span>
            <span class="p">]</span>

        <span class="n">weights_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">weights_series</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="p">,</span> <span class="n">Callable</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weight_func_</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">series_names_in_</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Series not present in weight_func have a weight of 1 in all their samples</span>
            <span class="n">series_not_in_weight_func</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="n">series_names_in_</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">series_not_in_weight_func</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">series_not_in_weight_func</span><span class="si">}</span><span class="s2"> not present in `weight_func`. &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;A weight of 1 is given to all their samples.&quot;</span><span class="p">),</span>
                     <span class="n">IgnoredArgumentWarning</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weight_func_</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span> 
                                 <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">series_names_in_</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">weight_func_</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func_</span>
            <span class="p">)</span>

        <span class="n">weights_samples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight_func_</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">==</span> <span class="s2">&quot;onehot&quot;</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">X_train</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="p">[</span>
                        <span class="n">X_train</span><span class="p">[</span><span class="s2">&quot;_level_skforecast&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_mapping_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                     <span class="p">]</span>
            <span class="n">weights_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight_func_</span><span class="p">[</span><span class="n">key</span><span class="p">](</span><span class="n">idx</span><span class="p">))</span>
        <span class="n">weights_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">weights_samples</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">weights_series</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">weights_series</span>
        <span class="k">if</span> <span class="n">weights_samples</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span> <span class="o">*</span> <span class="n">weights_samples</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">weights_samples</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">weights_samples</span>

    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The resulting `weights` cannot have NaN values.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">weights</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The resulting `weights` cannot have negative values.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;The resulting `weights` cannot be normalized because &quot;</span>
                 <span class="s2">&quot;the sum of the weights is zero.&quot;</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">weights</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.fit" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">fit</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.fit" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">fit</span><span class="p">(</span>
    <span class="n">series</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">store_last_window</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">store_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Training Forecaster. See Notes section for more details depending on 
the type of <code>series</code> and <code>exog</code>.</p>
<p>Additional arguments to be passed to the <code>fit</code> method of the regressor 
can be added with the <code>fit_kwargs</code> argument when initializing the forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>series</code></td>
            <td>
                  <code>pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Training time series.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>store_last_window</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not to store the last window (<code>last_window_</code>) of training data.</p>
<ul>
<li>If <code>True</code>, last window is stored for all series. </li>
<li>If <code>list</code>, last window is stored for the series present in the list.</li>
<li>If <code>False</code>, last window is not stored.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>store_in_sample_residuals</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, in-sample residuals will be stored in the forecaster object
after fitting (<code>in_sample_residuals_</code> attribute).</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the training 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <ul>
<li>If <code>series</code> is a pandas DataFrame and <code>exog</code> is a pandas Series or 
DataFrame, each exog is duplicated for each series. Exog must have the
same index as <code>series</code> (type, length and frequency).</li>
<li>If <code>series</code> is a pandas DataFrame and <code>exog</code> is a dict of pandas Series 
or DataFrames. Each key in <code>exog</code> must be a column in <code>series</code> and the 
values are the exog for each series. Exog must have the same index as 
<code>series</code> (type, length and frequency).</li>
<li>If <code>series</code> is a dict of pandas Series, <code>exog</code>must be a dict of pandas
Series or DataFrames. The keys in <code>series</code> and <code>exog</code> must be the same.
All series and exog must have a pandas DatetimeIndex with the same 
frequency.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">series</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">store_last_window</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">store_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Training Forecaster. See Notes section for more details depending on </span>
<span class="sd">    the type of `series` and `exog`.</span>

<span class="sd">    Additional arguments to be passed to the `fit` method of the regressor </span>
<span class="sd">    can be added with the `fit_kwargs` argument when initializing the forecaster.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    series : pandas DataFrame, dict</span>
<span class="sd">        Training time series.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    store_last_window : bool, list, default `True`</span>
<span class="sd">        Whether or not to store the last window (`last_window_`) of training data.</span>

<span class="sd">        - If `True`, last window is stored for all series. </span>
<span class="sd">        - If `list`, last window is stored for the series present in the list.</span>
<span class="sd">        - If `False`, last window is not stored.</span>
<span class="sd">    store_in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, in-sample residuals will be stored in the forecaster object</span>
<span class="sd">        after fitting (`in_sample_residuals_` attribute).</span>
<span class="sd">    suppress_warnings : bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the training </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - If `series` is a pandas DataFrame and `exog` is a pandas Series or </span>
<span class="sd">    DataFrame, each exog is duplicated for each series. Exog must have the</span>
<span class="sd">    same index as `series` (type, length and frequency).</span>
<span class="sd">    - If `series` is a pandas DataFrame and `exog` is a dict of pandas Series </span>
<span class="sd">    or DataFrames. Each key in `exog` must be a column in `series` and the </span>
<span class="sd">    values are the exog for each series. Exog must have the same index as </span>
<span class="sd">    `series` (type, length and frequency).</span>
<span class="sd">    - If `series` is a dict of pandas Series, `exog`must be a dict of pandas</span>
<span class="sd">    Series or DataFrames. The keys in `series` and `exog` must be the same.</span>
<span class="sd">    All series and exog must have a pandas DatetimeIndex with the same </span>
<span class="sd">    frequency.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="c1"># Reset values in case the forecaster has already been fitted.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span>                       <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span>                        <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span>                        <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span>                    <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">series_names_in_</span>                   <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span>                           <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span>                     <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span>                      <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span>                    <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_series_names_in_</span>           <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span>            <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span>        <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span>               <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span>                          <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span>                           <span class="o">=</span> <span class="kc">None</span>

    <span class="p">(</span>
        <span class="n">X_train</span><span class="p">,</span>
        <span class="n">y_train</span><span class="p">,</span>
        <span class="n">series_indexes</span><span class="p">,</span>
        <span class="n">series_names_in_</span><span class="p">,</span>
        <span class="n">X_train_series_names_in_</span><span class="p">,</span>
        <span class="n">exog_names_in_</span><span class="p">,</span>
        <span class="n">X_train_window_features_names_out_</span><span class="p">,</span>
        <span class="n">X_train_exog_names_out_</span><span class="p">,</span>
        <span class="n">exog_dtypes_in_</span><span class="p">,</span>
        <span class="n">last_window_</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_train_X_y</span><span class="p">(</span>
            <span class="n">series</span><span class="o">=</span><span class="n">series</span><span class="p">,</span> <span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">,</span> <span class="n">store_last_window</span><span class="o">=</span><span class="n">store_last_window</span>
        <span class="p">)</span>

    <span class="n">sample_weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_sample_weights</span><span class="p">(</span>
                        <span class="n">series_names_in_</span> <span class="o">=</span> <span class="n">series_names_in_</span><span class="p">,</span>
                        <span class="n">X_train</span>          <span class="o">=</span> <span class="n">X_train</span>
                    <span class="p">)</span>

    <span class="n">X_train_regressor</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">X_train</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s2">&quot;_level_skforecast&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">sample_weight</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">X</span>             <span class="o">=</span> <span class="n">X_train_regressor</span><span class="p">,</span>
            <span class="n">y</span>             <span class="o">=</span> <span class="n">y_train</span><span class="p">,</span>
            <span class="n">sample_weight</span> <span class="o">=</span> <span class="n">sample_weight</span><span class="p">,</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_train_regressor</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">series_names_in_</span> <span class="o">=</span> <span class="n">series_names_in_</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_series_names_in_</span> <span class="o">=</span> <span class="n">X_train_series_names_in_</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span> <span class="o">=</span> <span class="n">X_train_window_features_names_out_</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span> <span class="o">=</span> <span class="n">X_train_regressor</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fit_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">training_range_</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">series_indexes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">series_indexes</span><span class="p">[</span><span class="n">series_names_in_</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">series_indexes</span><span class="p">[</span><span class="n">series_names_in_</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="n">series_indexes</span><span class="p">[</span><span class="n">series_names_in_</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">freqstr</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span> <span class="o">=</span> <span class="n">series_indexes</span><span class="p">[</span><span class="n">series_names_in_</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">step</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span> <span class="o">=</span> <span class="n">exog_names_in_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">exog</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span> <span class="o">=</span> <span class="n">exog_dtypes_in_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span> <span class="o">=</span> <span class="n">X_train_exog_names_out_</span>

    <span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">store_in_sample_residuals</span><span class="p">:</span>

        <span class="n">residuals</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_train</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_regressor</span><span class="p">))</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X_train_series_names_in_</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">==</span> <span class="s1">&#39;onehot&#39;</span><span class="p">:</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="o">==</span> <span class="mf">1.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">encoded_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_mapping_</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">&#39;_level_skforecast&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="o">==</span> <span class="n">encoded_value</span>

                <span class="n">residuals_col</span> <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals_col</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
                    <span class="n">residuals_col</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                                        <span class="n">a</span>       <span class="o">=</span> <span class="n">residuals_col</span><span class="p">,</span>
                                        <span class="n">size</span>    <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
                                        <span class="n">replace</span> <span class="o">=</span> <span class="kc">False</span>
                                    <span class="p">)</span>
                <span class="n">in_sample_residuals_</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">residuals_col</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="n">in_sample_residuals_</span><span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                                                        <span class="n">a</span>       <span class="o">=</span> <span class="n">residuals</span><span class="p">,</span>
                                                        <span class="n">size</span>    <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
                                                        <span class="n">replace</span> <span class="o">=</span> <span class="kc">False</span>
                                                    <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">in_sample_residuals_</span><span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">residuals</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X_train_series_names_in_</span><span class="p">:</span>
                <span class="n">in_sample_residuals_</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">in_sample_residuals_</span><span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span> <span class="o">=</span> <span class="n">in_sample_residuals_</span>

    <span class="k">if</span> <span class="n">store_last_window</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span> <span class="o">=</span> <span class="n">last_window_</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_predict_inputs" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_create_predict_inputs</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._create_predict_inputs" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_create_predict_inputs</span><span class="p">(</span>
    <span class="n">steps</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">predict_boot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create the inputs needed for the first iteration of the prediction 
process. As this is a recursive process, the last window is updated at 
each iteration of the prediction process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of future steps predicted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series to be predicted. If <code>None</code> all levels whose last window
ends at the same datetime index will be predicted together.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>last_window</code></td>
            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>predict_boot</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals are returned to generate bootstrapping predictions.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>use_in_sample_residuals</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create predictions. If <code>False</code>, out of sample 
residuals are used. In the latter case, the user should have
calculated and stored the residuals within the forecaster (see
<code>set_out_sample_residuals()</code>).</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>check_inputs</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the input is checked for possible warnings and errors 
with the <code>check_predict_input</code> function. This argument is created 
for internal use and is not recommended to be changed.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>last_window</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors needed in the first 
iteration of the prediction (t + 1).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>exog_values_dict</code></td>            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>, None)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s for each series in 
each step. The keys are the steps and the values are numpy arrays
where each column is an exog and each row a series (level).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>levels</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the series (levels) to be predicted.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>prediction_index</code></td>            <td>
                  <code>pandas Index</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of the predictions.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>residuals</code></td>            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>, None)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residuals used to generate bootstrapping predictions for each level 
in the form <code>{level: residuals}</code>. If <code>predict_boot = False</code>, 
<code>residuals</code> is <code>None</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_create_predict_inputs</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">predict_boot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">list</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create the inputs needed for the first iteration of the prediction </span>
<span class="sd">    process. As this is a recursive process, the last window is updated at </span>
<span class="sd">    each iteration of the prediction process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted. If `None` all levels whose last window</span>
<span class="sd">        ends at the same datetime index will be predicted together.</span>
<span class="sd">    last_window : pandas DataFrame, default `None`</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">        If `last_window = None`, the values stored in `self.last_window_` are</span>
<span class="sd">        used to calculate the initial predictors, and the predictions start</span>
<span class="sd">        right after training data.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    predict_boot : bool, default `False`</span>
<span class="sd">        If `True`, residuals are returned to generate bootstrapping predictions.</span>
<span class="sd">    use_in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create predictions. If `False`, out of sample </span>
<span class="sd">        residuals are used. In the latter case, the user should have</span>
<span class="sd">        calculated and stored the residuals within the forecaster (see</span>
<span class="sd">        `set_out_sample_residuals()`).</span>
<span class="sd">    check_inputs : bool, default `True`</span>
<span class="sd">        If `True`, the input is checked for possible warnings and errors </span>
<span class="sd">        with the `check_predict_input` function. This argument is created </span>
<span class="sd">        for internal use and is not recommended to be changed.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    last_window : pandas DataFrame</span>
<span class="sd">        Series values used to create the predictors needed in the first </span>
<span class="sd">        iteration of the prediction (t + 1).</span>
<span class="sd">    exog_values_dict : dict, None</span>
<span class="sd">        Exogenous variable/s included as predictor/s for each series in </span>
<span class="sd">        each step. The keys are the steps and the values are numpy arrays</span>
<span class="sd">        where each column is an exog and each row a series (level).</span>
<span class="sd">    levels : list</span>
<span class="sd">        Names of the series (levels) to be predicted.</span>
<span class="sd">    prediction_index : pandas Index</span>
<span class="sd">        Index of the predictions.</span>
<span class="sd">    residuals : dict, None</span>
<span class="sd">        Residuals used to generate bootstrapping predictions for each level </span>
<span class="sd">        in the form `{level: residuals}`. If `predict_boot = False`, </span>
<span class="sd">        `residuals` is `None`.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">levels</span><span class="p">,</span> <span class="n">input_levels_is_list</span> <span class="o">=</span> <span class="n">prepare_levels_multiseries</span><span class="p">(</span>
        <span class="n">X_train_series_names_in_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_series_names_in_</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="ow">and</span> <span class="n">last_window</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">levels</span><span class="p">,</span> <span class="n">last_window</span> <span class="o">=</span> <span class="n">preprocess_levels_self_last_window_multiseries</span><span class="p">(</span>
                                  <span class="n">levels</span>               <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                                  <span class="n">input_levels_is_list</span> <span class="o">=</span> <span class="n">input_levels_is_list</span><span class="p">,</span>
                                  <span class="n">last_window_</span>         <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_window_</span>
                              <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span> <span class="ow">and</span> <span class="n">predict_boot</span><span class="p">:</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="n">prepare_residuals_multiseries</span><span class="p">(</span>
                        <span class="n">levels</span>                  <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                        <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
                        <span class="n">encoding</span>                <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
                        <span class="n">in_sample_residuals_</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_sample_residuals_</span><span class="p">,</span>
                        <span class="n">out_sample_residuals_</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span>
                    <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">check_inputs</span><span class="p">:</span>
        <span class="n">check_predict_input</span><span class="p">(</span>
            <span class="n">forecaster_name</span>  <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="n">steps</span>            <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
            <span class="n">is_fitted</span>        <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">,</span>
            <span class="n">exog_in_</span>         <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_in_</span><span class="p">,</span>
            <span class="n">index_type_</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_type_</span><span class="p">,</span>
            <span class="n">index_freq_</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_freq_</span><span class="p">,</span>
            <span class="n">window_size</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">,</span>
            <span class="n">last_window</span>      <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
            <span class="n">exog</span>             <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
            <span class="n">exog_type_in_</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_type_in_</span><span class="p">,</span>
            <span class="n">exog_names_in_</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_names_in_</span><span class="p">,</span>
            <span class="n">interval</span>         <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">levels</span>           <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
            <span class="n">series_names_in_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series_names_in_</span><span class="p">,</span>
            <span class="n">encoding</span>         <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span>
        <span class="p">)</span>

    <span class="n">last_window</span> <span class="o">=</span> <span class="n">last_window</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span>
        <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="p">:,</span> <span class="n">last_window</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_indexer</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
    <span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">last_window_index</span> <span class="o">=</span> <span class="n">preprocess_last_window</span><span class="p">(</span>
                               <span class="n">last_window</span>   <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                               <span class="n">return_values</span> <span class="o">=</span> <span class="kc">False</span>
                           <span class="p">)</span>
    <span class="n">prediction_index</span> <span class="o">=</span> <span class="n">expand_index</span><span class="p">(</span>
                           <span class="n">index</span> <span class="o">=</span> <span class="n">last_window_index</span><span class="p">,</span>
                           <span class="n">steps</span> <span class="o">=</span> <span class="n">steps</span>
                       <span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># Empty dataframe to be filled with the exog values of each level</span>
            <span class="n">empty_exog</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                             <span class="n">data</span>  <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
                                      <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exog_dtypes_in_</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
                             <span class="n">index</span> <span class="o">=</span> <span class="n">prediction_index</span>
                         <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                <span class="n">exog</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

            <span class="n">exog</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
                       <span class="n">df</span>                <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                       <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
                       <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                       <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                   <span class="p">)</span>
            <span class="n">check_exog_dtypes</span><span class="p">(</span><span class="n">exog</span><span class="o">=</span><span class="n">exog</span><span class="p">)</span>
            <span class="n">exog_values</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:</span><span class="n">steps</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">exog_values</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">exog_values_all_levels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">:</span>
        <span class="n">last_window_level</span> <span class="o">=</span> <span class="n">last_window</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">last_window_level</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
            <span class="n">array</span>             <span class="o">=</span> <span class="n">last_window_level</span><span class="p">,</span>
            <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]),</span>
            <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiator_</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">differentiator_</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="p">)</span>
            <span class="n">last_window_level</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">differentiator_</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">last_window_level</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">last_window</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_window_level</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="c1"># Fill the empty dataframe with the exog values of each level</span>
            <span class="c1"># and transform them if necessary</span>
            <span class="n">exog_values</span> <span class="o">=</span> <span class="n">exog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">exog_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">exog_values</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
                    <span class="n">exog_values</span> <span class="o">=</span> <span class="n">exog_values</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

                <span class="n">exog_values</span> <span class="o">=</span> <span class="n">empty_exog</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">exog_values</span><span class="p">)</span>
                <span class="n">exog_values</span> <span class="o">=</span> <span class="n">transform_dataframe</span><span class="p">(</span>
                                  <span class="n">df</span>                <span class="o">=</span> <span class="n">exog_values</span><span class="p">,</span>
                                  <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_exog</span><span class="p">,</span>
                                  <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                  <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                              <span class="p">)</span>

                <span class="n">check_exog_dtypes</span><span class="p">(</span>
                    <span class="n">exog</span>      <span class="o">=</span> <span class="n">exog_values</span><span class="p">,</span>
                    <span class="n">series_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;`exog` for series &#39;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
                <span class="p">)</span>
                <span class="n">exog_values</span> <span class="o">=</span> <span class="n">exog_values</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">exog_values</span> <span class="o">=</span> <span class="n">empty_exog</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">exog_values_all_levels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog_values</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Exog is transformed into a dict where each key is a step and each value</span>
        <span class="c1"># is a numpy array where each column is an exog and each row a series</span>
        <span class="n">exog_values_all_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">exog_values_all_levels</span><span class="p">)</span>
        <span class="n">exog_values_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
            <span class="n">exog_values_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">exog_values_all_levels</span><span class="p">[</span><span class="n">i</span><span class="p">::</span><span class="n">steps</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">exog_values_dict</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">last_window</span><span class="p">,</span> <span class="n">exog_values_dict</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">prediction_index</span><span class="p">,</span> <span class="n">residuals</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._recursive_predict" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">_recursive_predict</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries._recursive_predict" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">_recursive_predict</span><span class="p">(</span>
    <span class="n">steps</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">,</span>
    <span class="n">exog_values_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">residuals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Predict n steps for one or multiple levels. It is an iterative process
in which, each prediction, is used as a predictor for the next step.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of future steps predicted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series to be predicted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>last_window</code></td>
            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors needed in the first 
iteration of the prediction (t + 1).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog_values_dict</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s for each series in 
each step. The keys are the steps and the values are numpy arrays
where each column is an exog and each row a series (level).</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>residuals</code></td>
            <td>
                  <code>numpy ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Residuals used to generate bootstrapping predictions in the form
(steps, levels).</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>predictions</code></td>            <td>
                  <code>numpy ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">_recursive_predict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">exog_values_dict</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">residuals</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predict n steps for one or multiple levels. It is an iterative process</span>
<span class="sd">    in which, each prediction, is used as a predictor for the next step.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    levels : list</span>
<span class="sd">        Time series to be predicted.</span>
<span class="sd">    last_window : pandas DataFrame</span>
<span class="sd">        Series values used to create the predictors needed in the first </span>
<span class="sd">        iteration of the prediction (t + 1).</span>
<span class="sd">    exog_values_dict : dict, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s for each series in </span>
<span class="sd">        each step. The keys are the steps and the values are numpy arrays</span>
<span class="sd">        where each column is an exog and each row a series (level).</span>
<span class="sd">    residuals : numpy ndarray, default `None`</span>
<span class="sd">        Residuals used to generate bootstrapping predictions in the form</span>
<span class="sd">        (steps, levels).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions : numpy ndarray</span>
<span class="sd">        Predicted values.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_levels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
    <span class="n">n_lags</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">n_window_features</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">else</span> <span class="mi">0</span>
    <span class="p">)</span>
    <span class="n">n_autoreg</span> <span class="o">=</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="n">n_window_features</span>
    <span class="n">n_exog</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span><span class="p">)</span> <span class="k">if</span> <span class="n">exog_values_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">==</span> <span class="s2">&quot;onehot&quot;</span><span class="p">:</span>
            <span class="n">levels_encoded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                <span class="p">(</span><span class="n">n_levels</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_series_names_in_</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">levels</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">level</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train_series_names_in_</span><span class="p">:</span>
                    <span class="n">levels_encoded</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train_series_names_in_</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">level</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">levels_encoded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_mapping_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">],</span>
                <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float64&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">levels_encoded_shape</span> <span class="o">=</span> <span class="n">levels_encoded</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">levels_encoded_shape</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">features_shape</span> <span class="o">=</span> <span class="n">n_autoreg</span> <span class="o">+</span> <span class="n">levels_encoded_shape</span> <span class="o">+</span> <span class="n">n_exog</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_levels</span><span class="p">,</span> <span class="n">features_shape</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">features</span><span class="p">[:,</span> <span class="n">n_autoreg</span><span class="p">:</span> <span class="n">n_autoreg</span> <span class="o">+</span> <span class="n">levels_encoded_shape</span><span class="p">]</span> <span class="o">=</span> <span class="n">levels_encoded</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_levels</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span>
    <span class="p">)</span>
    <span class="n">last_window</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">last_window</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">predictions</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">features</span><span class="p">[:,</span> <span class="p">:</span><span class="n">n_lags</span><span class="p">]</span> <span class="o">=</span> <span class="n">last_window</span><span class="p">[</span>
                <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="o">-</span> <span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="p">:</span>
            <span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">features</span><span class="p">[:,</span> <span class="n">n_lags</span><span class="p">:</span><span class="n">n_autoreg</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">wf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">last_window</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="p">:])</span> 
                    <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span>
                <span class="p">],</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">exog_values_dict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">features</span><span class="p">[:,</span> <span class="o">-</span><span class="n">n_exog</span><span class="p">:]</span> <span class="o">=</span> <span class="n">exog_values_dict</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">residuals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pred</span> <span class="o">+=</span> <span class="n">residuals</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>

        <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pred</span> 

        <span class="c1"># Update `last_window` values. The first position is discarded and </span>
        <span class="c1"># the new prediction is added at the end.</span>
        <span class="n">last_window</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">i</span><span class="p">),</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pred</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.create_predict_X" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">create_predict_X</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.create_predict_X" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">create_predict_X</span><span class="p">(</span>
    <span class="n">steps</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create the predictors needed to predict <code>steps</code> ahead. As it is a recursive
process, the predictors are created at each iteration of the prediction 
process.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of future steps predicted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series to be predicted. If <code>None</code> all levels whose last window
ends at the same datetime index will be predicted together.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>last_window</code></td>
            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the prediction 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>X_predict_dict</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict in the form <code>{level: X_predict}</code> with the predictors for each 
step and series. The index is the same as the prediction index.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_predict_X</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create the predictors needed to predict `steps` ahead. As it is a recursive</span>
<span class="sd">    process, the predictors are created at each iteration of the prediction </span>
<span class="sd">    process.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted. If `None` all levels whose last window</span>
<span class="sd">        ends at the same datetime index will be predicted together.</span>
<span class="sd">    last_window : pandas DataFrame, default `None`</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">        If `last_window = None`, the values stored in `self.last_window_` are</span>
<span class="sd">        used to calculate the initial predictors, and the predictions start</span>
<span class="sd">        right after training data.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    suppress_warnings : bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the prediction </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X_predict_dict : dict</span>
<span class="sd">        Dict in the form `{level: X_predict}` with the predictors for each </span>
<span class="sd">        step and series. The index is the same as the prediction index.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="p">(</span>
        <span class="n">last_window</span><span class="p">,</span>
        <span class="n">exog_values_dict</span><span class="p">,</span>
        <span class="n">levels</span><span class="p">,</span>
        <span class="n">prediction_index</span><span class="p">,</span>
        <span class="n">_</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
        <span class="n">steps</span>        <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">levels</span>       <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
        <span class="n">last_window</span>  <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
        <span class="n">exog</span>         <span class="o">=</span> <span class="n">exog</span>
    <span class="p">)</span>

    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
            <span class="s2">&quot;ignore&quot;</span><span class="p">,</span> 
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span> 
            <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span>
        <span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
                          <span class="n">steps</span>            <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                          <span class="n">levels</span>           <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                          <span class="n">last_window</span>      <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                          <span class="n">exog_values_dict</span> <span class="o">=</span> <span class="n">exog_values_dict</span>
                      <span class="p">)</span>

    <span class="n">X_predict_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">idx_lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">steps</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span>
    <span class="n">len_X_train_series_names_in_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_series_names_in_</span><span class="p">)</span>
    <span class="n">exog_shape</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_exog_names_out_</span><span class="p">)</span> <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">levels</span><span class="p">):</span>

        <span class="n">X_predict_level</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">full_predictors_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
            <span class="p">(</span><span class="n">last_window</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">predictions</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">X_predict_level</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">full_predictors_level</span><span class="p">[</span><span class="n">idx_lags</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">full_predictors_level</span><span class="p">)]</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">X_window_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
                <span class="n">shape</span>      <span class="o">=</span> <span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_window_features_names_out_</span><span class="p">)),</span> 
                <span class="n">fill_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> 
                <span class="n">order</span>      <span class="o">=</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
                <span class="n">dtype</span>      <span class="o">=</span> <span class="nb">float</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
                <span class="n">X_window_features</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">wf</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">full_predictors_level</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="o">-</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="n">j</span><span class="p">)])</span> 
                        <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="n">X_predict_level</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_window_features</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="o">==</span> <span class="s1">&#39;onehot&#39;</span><span class="p">:</span>
                <span class="n">level_encoded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                                    <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">len_X_train_series_names_in_</span><span class="p">),</span>
                                    <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span>
                                <span class="p">)</span>
                <span class="n">level_encoded</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">X_train_series_names_in_</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">level</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">level_encoded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_mapping_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="kc">None</span><span class="p">)],</span>
                                    <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;float64&#39;</span>
                                <span class="p">)</span>

            <span class="n">level_encoded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">level_encoded</span><span class="p">,</span> <span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">X_predict_level</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">level_encoded</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">exog</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">exog_cols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
                <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">exog_shape</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
                <span class="n">exog_cols</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">exog_values_dict</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">X_predict_level</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exog_cols</span><span class="p">)</span>

        <span class="n">X_predict_dict</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                                    <span class="n">data</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">X_predict_level</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                                    <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="p">,</span>
                                    <span class="n">index</span>   <span class="o">=</span> <span class="n">prediction_index</span>
                                <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;The output matrix is in the transformed scale due to the &quot;</span>
            <span class="s2">&quot;inclusion of transformations or differentiation in the Forecaster. &quot;</span>
            <span class="s2">&quot;As a result, any predictions generated using this matrix will also &quot;</span>
            <span class="s2">&quot;be in the transformed scale. Please refer to the documentation &quot;</span>
            <span class="s2">&quot;for more details: &quot;</span>
            <span class="s2">&quot;https://skforecast.org/latest/user_guides/training-and-prediction-matrices.html&quot;</span><span class="p">,</span>
            <span class="n">DataTransformationWarning</span>
        <span class="p">)</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_predict_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">predict</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">predict</span><span class="p">(</span>
    <span class="n">steps</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">check_inputs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Predict n steps ahead. It is an recursive process in which, each prediction,
is used as a predictor for the next step. Only levels whose last window
ends at the same datetime index can be predicted together.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of future steps predicted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series to be predicted. If <code>None</code> all levels whose last window
ends at the same datetime index will be predicted together.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>last_window</code></td>
            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the prediction 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>check_inputs</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, the input is checked for possible warnings and errors 
with the <code>check_predict_input</code> function. This argument is created 
for internal use and is not recommended to be changed.</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>predictions</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predicted values, one column for each level.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">check_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Predict n steps ahead. It is an recursive process in which, each prediction,</span>
<span class="sd">    is used as a predictor for the next step. Only levels whose last window</span>
<span class="sd">    ends at the same datetime index can be predicted together.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted. If `None` all levels whose last window</span>
<span class="sd">        ends at the same datetime index will be predicted together.</span>
<span class="sd">    last_window : pandas DataFrame, default `None`</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">        If `last_window = None`, the values stored in `self.last_window_` are</span>
<span class="sd">        used to calculate the initial predictors, and the predictions start</span>
<span class="sd">        right after training data.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    suppress_warnings : bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the prediction </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>
<span class="sd">    check_inputs : bool, default `True`</span>
<span class="sd">        If `True`, the input is checked for possible warnings and errors </span>
<span class="sd">        with the `check_predict_input` function. This argument is created </span>
<span class="sd">        for internal use and is not recommended to be changed.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions : pandas DataFrame</span>
<span class="sd">        Predicted values, one column for each level.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="p">(</span>
        <span class="n">last_window</span><span class="p">,</span>
        <span class="n">exog_values_dict</span><span class="p">,</span>
        <span class="n">levels</span><span class="p">,</span>
        <span class="n">prediction_index</span><span class="p">,</span>
        <span class="n">_</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
        <span class="n">steps</span>        <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">levels</span>       <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
        <span class="n">last_window</span>  <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
        <span class="n">exog</span>         <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">check_inputs</span> <span class="o">=</span> <span class="n">check_inputs</span>
    <span class="p">)</span>

    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
            <span class="s2">&quot;ignore&quot;</span><span class="p">,</span> 
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span> 
            <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span>
        <span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
                          <span class="n">steps</span>            <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                          <span class="n">levels</span>           <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                          <span class="n">last_window</span>      <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                          <span class="n">exog_values_dict</span> <span class="o">=</span> <span class="n">exog_values_dict</span>
                      <span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">levels</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">predictions</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span>
                <span class="o">.</span><span class="n">differentiator_</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>
                <span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span><span class="n">predictions</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
            <span class="p">)</span>

        <span class="n">predictions</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
            <span class="n">array</span>             <span class="o">=</span> <span class="n">predictions</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span>
            <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]),</span>
            <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                      <span class="n">data</span>    <span class="o">=</span> <span class="n">predictions</span><span class="p">,</span>
                      <span class="n">index</span>   <span class="o">=</span> <span class="n">prediction_index</span><span class="p">,</span>
                      <span class="n">columns</span> <span class="o">=</span> <span class="n">levels</span>
                  <span class="p">)</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_bootstrapping" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">predict_bootstrapping</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_bootstrapping" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">predict_bootstrapping</span><span class="p">(</span>
    <span class="n">steps</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate multiple forecasting predictions using a bootstrapping process. 
By sampling from a collection of past observed errors (the residuals),
each iteration of bootstrapping generates a different set of predictions. 
Only levels whose last window ends at the same datetime index can be 
predicted together. See the Notes section for more information. </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of future steps predicted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series to be predicted. If <code>None</code> all levels whose last window
ends at the same datetime index will be predicted together.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>last_window</code></td>
            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_boot</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations used to estimate predictions.</p>
              </div>
            </td>
            <td>
                  <code>`250`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random generator, so that boot predictions are always 
deterministic.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>use_in_sample_residuals</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create predictions. If <code>False</code>, out of sample 
residuals are used. In the latter case, the user should have
calculated and stored the residuals within the forecaster (see
<code>set_out_sample_residuals()</code>).</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the prediction 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>boot_predictions</code></td>            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p DataFrame_="DataFrame," _steps_="(steps," level:="level:" n_boot_="n_boot)" pandas="pandas" shape="shape">Predictions generated by bootstrapping for each level.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>More information about prediction intervals in forecasting:
<a href="https://otexts.com/fpp3/prediction-intervals.html#prediction-intervals-from-bootstrapped-residuals">https://otexts.com/fpp3/prediction-intervals.html#prediction-intervals-from-bootstrapped-residuals</a>
Forecasting: Principles and Practice (3nd ed) Rob J Hyndman and George Athanasopoulos.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict_bootstrapping</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate multiple forecasting predictions using a bootstrapping process. </span>
<span class="sd">    By sampling from a collection of past observed errors (the residuals),</span>
<span class="sd">    each iteration of bootstrapping generates a different set of predictions. </span>
<span class="sd">    Only levels whose last window ends at the same datetime index can be </span>
<span class="sd">    predicted together. See the Notes section for more information. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted. If `None` all levels whose last window</span>
<span class="sd">        ends at the same datetime index will be predicted together.</span>
<span class="sd">    last_window : pandas DataFrame, default `None`</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">        If `last_window = None`, the values stored in `self.last_window_` are</span>
<span class="sd">        used to calculate the initial predictors, and the predictions start</span>
<span class="sd">        right after training data.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    n_boot : int, default `250`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate predictions.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot predictions are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    use_in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create predictions. If `False`, out of sample </span>
<span class="sd">        residuals are used. In the latter case, the user should have</span>
<span class="sd">        calculated and stored the residuals within the forecaster (see</span>
<span class="sd">        `set_out_sample_residuals()`).</span>
<span class="sd">    suppress_warnings : bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the prediction </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    boot_predictions : dict</span>
<span class="sd">        Predictions generated by bootstrapping for each level.</span>
<span class="sd">        {level: pandas DataFrame, shape (steps, n_boot)}</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    More information about prediction intervals in forecasting:</span>
<span class="sd">    https://otexts.com/fpp3/prediction-intervals.html#prediction-intervals-from-bootstrapped-residuals</span>
<span class="sd">    Forecasting: Principles and Practice (3nd ed) Rob J Hyndman and George Athanasopoulos.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="p">(</span>
        <span class="n">last_window</span><span class="p">,</span>
        <span class="n">exog_values_dict</span><span class="p">,</span>
        <span class="n">levels</span><span class="p">,</span>
        <span class="n">prediction_index</span><span class="p">,</span>
        <span class="n">residuals</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_predict_inputs</span><span class="p">(</span>
        <span class="n">steps</span>                   <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
        <span class="n">levels</span>                  <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
        <span class="n">last_window</span>             <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
        <span class="n">exog</span>                    <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
        <span class="n">predict_boot</span>            <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span>
    <span class="p">)</span>

    <span class="n">n_levels</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">sample_residuals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
                           <span class="n">shape</span>      <span class="o">=</span> <span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">,</span> <span class="n">n_levels</span><span class="p">),</span>
                           <span class="n">fill_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                           <span class="n">order</span>      <span class="o">=</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span>
                           <span class="n">dtype</span>      <span class="o">=</span> <span class="nb">float</span>
                       <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">levels</span><span class="p">):</span>
        <span class="n">sample_residuals</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
                                        <span class="n">a</span>       <span class="o">=</span> <span class="n">residuals</span><span class="p">[</span><span class="n">level</span><span class="p">],</span>
                                        <span class="n">size</span>    <span class="o">=</span> <span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">),</span>
                                        <span class="n">replace</span> <span class="o">=</span> <span class="kc">True</span>
                                    <span class="p">)</span>

    <span class="n">boot_columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">boot_predictions_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
                                <span class="n">shape</span>      <span class="o">=</span> <span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">n_levels</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">),</span>
                                <span class="n">fill_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                                <span class="n">order</span>      <span class="o">=</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span>
                                <span class="n">dtype</span>      <span class="o">=</span> <span class="nb">float</span>
                            <span class="p">)</span>

    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
            <span class="s2">&quot;ignore&quot;</span><span class="p">,</span> 
            <span class="n">message</span><span class="o">=</span><span class="s2">&quot;X does not have valid feature names&quot;</span><span class="p">,</span> 
            <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">):</span>

            <span class="n">boot_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;pred_boot_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">boot_predictions_full</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recursive_predict</span><span class="p">(</span>
                <span class="n">steps</span>            <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                <span class="n">levels</span>           <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                <span class="n">last_window</span>      <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                <span class="n">exog_values_dict</span> <span class="o">=</span> <span class="n">exog_values_dict</span><span class="p">,</span>
                <span class="n">residuals</span>        <span class="o">=</span> <span class="n">sample_residuals</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
            <span class="p">)</span>

    <span class="n">boot_predictions</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">level</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">levels</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">boot_predictions_full</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">differentiator_</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>
                <span class="o">.</span><span class="n">inverse_transform_next_window</span><span class="p">(</span><span class="n">boot_predictions_full</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
            <span class="p">)</span>

        <span class="n">transformer_level</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                                <span class="n">level</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]</span>
                            <span class="p">)</span>
        <span class="k">if</span> <span class="n">transformer_level</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">boot_predictions_full</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span>
                <span class="n">func1d</span>            <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">,</span>
                <span class="n">axis</span>              <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">arr</span>               <span class="o">=</span> <span class="n">boot_predictions_full</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
                <span class="n">transformer</span>       <span class="o">=</span> <span class="n">transformer_level</span><span class="p">,</span>
                <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="p">)</span>

        <span class="n">boot_predictions</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                                      <span class="n">data</span>    <span class="o">=</span> <span class="n">boot_predictions_full</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:],</span>
                                      <span class="n">index</span>   <span class="o">=</span> <span class="n">prediction_index</span><span class="p">,</span>
                                      <span class="n">columns</span> <span class="o">=</span> <span class="n">boot_columns</span>
                                  <span class="p">)</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">boot_predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_interval" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">predict_interval</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_interval" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">predict_interval</span><span class="p">(</span>
    <span class="n">steps</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Iterative process in which, each prediction, is used as a predictor
for the next step and bootstrapping is used to estimate prediction
intervals. Both predictions and intervals are returned.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of future steps predicted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series to be predicted. If <code>None</code> all levels whose last window
ends at the same datetime index will be predicted together.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>last_window</code></td>
            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>interval</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence of the prediction interval estimated. Sequence of 
percentiles to compute, which must be between 0 and 100 inclusive. 
For example, interval of 95% should be as <code>interval = [2.5, 97.5]</code>.</p>
              </div>
            </td>
            <td>
                  <code>`[5, 95]`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_boot</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations used to estimate prediction 
intervals.</p>
              </div>
            </td>
            <td>
                  <code>`250`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random generator, so that boot predictions are always 
deterministic.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>use_in_sample_residuals</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create predictions. If <code>False</code>, out of sample 
residuals are used. In the latter case, the user should have
calculated and stored the residuals within the forecaster (see
<code>set_out_sample_residuals()</code>).</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the prediction 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>predictions</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values predicted by the forecaster and their estimated interval.</p>
<ul>
<li>level: predictions.</li>
<li>level_lower_bound: lower bound of the interval.</li>
<li>level_upper_bound: upper bound of the interval.</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>More information about prediction intervals in forecasting:
<a href="https://otexts.com/fpp2/prediction-intervals.html">https://otexts.com/fpp2/prediction-intervals.html</a>
Forecasting: Principles and Practice (2<sup>nd</sup> ed) Rob J Hyndman and
George Athanasopoulos.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict_interval</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interval</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">],</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterative process in which, each prediction, is used as a predictor</span>
<span class="sd">    for the next step and bootstrapping is used to estimate prediction</span>
<span class="sd">    intervals. Both predictions and intervals are returned.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted. If `None` all levels whose last window</span>
<span class="sd">        ends at the same datetime index will be predicted together.</span>
<span class="sd">    last_window : pandas DataFrame, default `None`</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">        If `last_window = None`, the values stored in `self.last_window_` are</span>
<span class="sd">        used to calculate the initial predictors, and the predictions start</span>
<span class="sd">        right after training data.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    interval : list, default `[5, 95]`</span>
<span class="sd">        Confidence of the prediction interval estimated. Sequence of </span>
<span class="sd">        percentiles to compute, which must be between 0 and 100 inclusive. </span>
<span class="sd">        For example, interval of 95% should be as `interval = [2.5, 97.5]`.</span>
<span class="sd">    n_boot : int, default `250`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate prediction </span>
<span class="sd">        intervals.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot predictions are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    use_in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create predictions. If `False`, out of sample </span>
<span class="sd">        residuals are used. In the latter case, the user should have</span>
<span class="sd">        calculated and stored the residuals within the forecaster (see</span>
<span class="sd">        `set_out_sample_residuals()`).</span>
<span class="sd">    suppress_warnings : bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the prediction </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions : pandas DataFrame</span>
<span class="sd">        Values predicted by the forecaster and their estimated interval.</span>

<span class="sd">        - level: predictions.</span>
<span class="sd">        - level_lower_bound: lower bound of the interval.</span>
<span class="sd">        - level_upper_bound: upper bound of the interval.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    More information about prediction intervals in forecasting:</span>
<span class="sd">    https://otexts.com/fpp2/prediction-intervals.html</span>
<span class="sd">    Forecasting: Principles and Practice (2nd ed) Rob J Hyndman and</span>
<span class="sd">    George Athanasopoulos.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="n">check_interval</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">)</span>

    <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_bootstrapping</span><span class="p">(</span>
                           <span class="n">steps</span>                   <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                           <span class="n">levels</span>                  <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                           <span class="n">last_window</span>             <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                           <span class="n">exog</span>                    <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                           <span class="n">n_boot</span>                  <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
                           <span class="n">random_state</span>            <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
                           <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
                           <span class="n">suppress_warnings</span>       <span class="o">=</span> <span class="n">suppress_warnings</span>
                       <span class="p">)</span>

    <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
                <span class="n">steps</span>             <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                <span class="n">levels</span>            <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                <span class="n">last_window</span>       <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                <span class="n">exog</span>              <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                <span class="n">suppress_warnings</span> <span class="o">=</span> <span class="n">suppress_warnings</span><span class="p">,</span>
                <span class="n">check_inputs</span>      <span class="o">=</span> <span class="kc">False</span>
            <span class="p">)</span>

    <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">preds</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">preds_interval</span> <span class="o">=</span> <span class="n">boot_predictions</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">preds_interval</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s1">_lower_bound&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s1">_upper_bound&#39;</span><span class="p">]</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds_interval</span><span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_quantiles" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">predict_quantiles</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_quantiles" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">predict_quantiles</span><span class="p">(</span>
    <span class="n">steps</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">quantiles</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">],</span>
    <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the specified quantiles for each step. After generating 
multiple forecasting predictions through a bootstrapping process, each 
quantile is calculated for each step.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of future steps predicted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series to be predicted. If <code>None</code> all levels whose last window
ends at the same datetime index will be predicted together.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>last_window</code></td>
            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>quantiles</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence of quantiles to compute, which must be between 0 and 1 
inclusive. For example, quantiles of 0.05, 0.5 and 0.95 should be as 
<code>quantiles = [0.05, 0.5, 0.95]</code>.</p>
              </div>
            </td>
            <td>
                  <code>`[0.05, 0.5, 0.95]`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_boot</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations used to estimate quantiles.</p>
              </div>
            </td>
            <td>
                  <code>`250`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random generator, so that boot quantiles are always 
deterministic.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>use_in_sample_residuals</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create quantiles. If <code>False</code>, out of sample 
residuals are used. In the latter case, the user should have
calculated and stored the residuals within the forecaster (see
<code>set_out_sample_residuals()</code>).</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the prediction 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>predictions</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Quantiles predicted by the forecaster.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>More information about prediction intervals in forecasting:
<a href="https://otexts.com/fpp2/prediction-intervals.html">https://otexts.com/fpp2/prediction-intervals.html</a>
Forecasting: Principles and Practice (2<sup>nd</sup> ed) Rob J Hyndman and
George Athanasopoulos.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span>
<span class="normal">2545</span>
<span class="normal">2546</span>
<span class="normal">2547</span>
<span class="normal">2548</span>
<span class="normal">2549</span>
<span class="normal">2550</span>
<span class="normal">2551</span>
<span class="normal">2552</span>
<span class="normal">2553</span>
<span class="normal">2554</span>
<span class="normal">2555</span>
<span class="normal">2556</span>
<span class="normal">2557</span>
<span class="normal">2558</span>
<span class="normal">2559</span>
<span class="normal">2560</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict_quantiles</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">quantiles</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">],</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the specified quantiles for each step. After generating </span>
<span class="sd">    multiple forecasting predictions through a bootstrapping process, each </span>
<span class="sd">    quantile is calculated for each step.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted. If `None` all levels whose last window</span>
<span class="sd">        ends at the same datetime index will be predicted together.</span>
<span class="sd">    last_window : pandas DataFrame, default `None`</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">        If `last_window = None`, the values stored in `self.last_window_` are</span>
<span class="sd">        used to calculate the initial predictors, and the predictions start</span>
<span class="sd">        right after training data.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    quantiles : list, default `[0.05, 0.5, 0.95]`</span>
<span class="sd">        Sequence of quantiles to compute, which must be between 0 and 1 </span>
<span class="sd">        inclusive. For example, quantiles of 0.05, 0.5 and 0.95 should be as </span>
<span class="sd">        `quantiles = [0.05, 0.5, 0.95]`.</span>
<span class="sd">    n_boot : int, default `250`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate quantiles.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot quantiles are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    use_in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create quantiles. If `False`, out of sample </span>
<span class="sd">        residuals are used. In the latter case, the user should have</span>
<span class="sd">        calculated and stored the residuals within the forecaster (see</span>
<span class="sd">        `set_out_sample_residuals()`).</span>
<span class="sd">    suppress_warnings : bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the prediction </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions : pandas DataFrame</span>
<span class="sd">        Quantiles predicted by the forecaster.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    More information about prediction intervals in forecasting:</span>
<span class="sd">    https://otexts.com/fpp2/prediction-intervals.html</span>
<span class="sd">    Forecasting: Principles and Practice (2nd ed) Rob J Hyndman and</span>
<span class="sd">    George Athanasopoulos.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="n">check_interval</span><span class="p">(</span><span class="n">quantiles</span><span class="o">=</span><span class="n">quantiles</span><span class="p">)</span>

    <span class="n">boot_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_bootstrapping</span><span class="p">(</span>
                           <span class="n">steps</span>                   <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                           <span class="n">levels</span>                  <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                           <span class="n">last_window</span>             <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                           <span class="n">exog</span>                    <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                           <span class="n">n_boot</span>                  <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
                           <span class="n">random_state</span>            <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
                           <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
                           <span class="n">suppress_warnings</span>       <span class="o">=</span> <span class="n">suppress_warnings</span>
                       <span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">boot_predictions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">preds_quantiles</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">boot_predictions</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span><span class="o">=</span><span class="n">quantiles</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="n">preds_quantiles</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s1">_q_</span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">quantiles</span><span class="p">]</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preds_quantiles</span><span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_dist" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">predict_dist</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.predict_dist" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">predict_dist</span><span class="p">(</span>
    <span class="n">steps</span><span class="p">,</span>
    <span class="n">distribution</span><span class="p">,</span>
    <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Fit a given probability distribution for each step. After generating 
multiple forecasting predictions through a bootstrapping process, each 
step is fitted to the given distribution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>steps</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of future steps predicted.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>distribution</code></td>
            <td>
                  <code>Object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A distribution object from scipy.stats. For example scipy.stats.norm.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>levels</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time series to be predicted. If <code>None</code> all levels whose last window
ends at the same datetime index will be predicted together.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>last_window</code></td>
            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Series values used to create the predictors (lags) needed in the 
first iteration of the prediction (t + 1).
If <code>last_window = None</code>, the values stored in <code>self.last_window_</code> are
used to calculate the initial predictors, and the predictions start
right after training data.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exog</code></td>
            <td>
                  <code>pandas Series, pandas DataFrame, dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exogenous variable/s included as predictor/s.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_boot</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bootstrapping iterations used to estimate predictions.</p>
              </div>
            </td>
            <td>
                  <code>`250`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random generator, so that boot predictions are always 
deterministic.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>use_in_sample_residuals</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, residuals from the training data are used as proxy of
prediction error to create predictions. If <code>False</code>, out of sample 
residuals are used. In the latter case, the user should have
calculated and stored the residuals within the forecaster (see
<code>set_out_sample_residuals()</code>).</p>
              </div>
            </td>
            <td>
                  <code>`True`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>suppress_warnings</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, skforecast warnings will be suppressed during the prediction 
process. See skforecast.exceptions.warn_skforecast_categories for more
information.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>predictions</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distribution parameters estimated for each step and level.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2563</span>
<span class="normal">2564</span>
<span class="normal">2565</span>
<span class="normal">2566</span>
<span class="normal">2567</span>
<span class="normal">2568</span>
<span class="normal">2569</span>
<span class="normal">2570</span>
<span class="normal">2571</span>
<span class="normal">2572</span>
<span class="normal">2573</span>
<span class="normal">2574</span>
<span class="normal">2575</span>
<span class="normal">2576</span>
<span class="normal">2577</span>
<span class="normal">2578</span>
<span class="normal">2579</span>
<span class="normal">2580</span>
<span class="normal">2581</span>
<span class="normal">2582</span>
<span class="normal">2583</span>
<span class="normal">2584</span>
<span class="normal">2585</span>
<span class="normal">2586</span>
<span class="normal">2587</span>
<span class="normal">2588</span>
<span class="normal">2589</span>
<span class="normal">2590</span>
<span class="normal">2591</span>
<span class="normal">2592</span>
<span class="normal">2593</span>
<span class="normal">2594</span>
<span class="normal">2595</span>
<span class="normal">2596</span>
<span class="normal">2597</span>
<span class="normal">2598</span>
<span class="normal">2599</span>
<span class="normal">2600</span>
<span class="normal">2601</span>
<span class="normal">2602</span>
<span class="normal">2603</span>
<span class="normal">2604</span>
<span class="normal">2605</span>
<span class="normal">2606</span>
<span class="normal">2607</span>
<span class="normal">2608</span>
<span class="normal">2609</span>
<span class="normal">2610</span>
<span class="normal">2611</span>
<span class="normal">2612</span>
<span class="normal">2613</span>
<span class="normal">2614</span>
<span class="normal">2615</span>
<span class="normal">2616</span>
<span class="normal">2617</span>
<span class="normal">2618</span>
<span class="normal">2619</span>
<span class="normal">2620</span>
<span class="normal">2621</span>
<span class="normal">2622</span>
<span class="normal">2623</span>
<span class="normal">2624</span>
<span class="normal">2625</span>
<span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span>
<span class="normal">2629</span>
<span class="normal">2630</span>
<span class="normal">2631</span>
<span class="normal">2632</span>
<span class="normal">2633</span>
<span class="normal">2634</span>
<span class="normal">2635</span>
<span class="normal">2636</span>
<span class="normal">2637</span>
<span class="normal">2638</span>
<span class="normal">2639</span>
<span class="normal">2640</span>
<span class="normal">2641</span>
<span class="normal">2642</span>
<span class="normal">2643</span>
<span class="normal">2644</span>
<span class="normal">2645</span>
<span class="normal">2646</span>
<span class="normal">2647</span>
<span class="normal">2648</span>
<span class="normal">2649</span>
<span class="normal">2650</span>
<span class="normal">2651</span>
<span class="normal">2652</span>
<span class="normal">2653</span>
<span class="normal">2654</span>
<span class="normal">2655</span>
<span class="normal">2656</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">predict_dist</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">distribution</span><span class="p">:</span> <span class="nb">object</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">last_window</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exog</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_boot</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">250</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
    <span class="n">use_in_sample_residuals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">suppress_warnings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fit a given probability distribution for each step. After generating </span>
<span class="sd">    multiple forecasting predictions through a bootstrapping process, each </span>
<span class="sd">    step is fitted to the given distribution.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    steps : int</span>
<span class="sd">        Number of future steps predicted.</span>
<span class="sd">    distribution : Object</span>
<span class="sd">        A distribution object from scipy.stats. For example scipy.stats.norm.</span>
<span class="sd">    levels : str, list, default `None`</span>
<span class="sd">        Time series to be predicted. If `None` all levels whose last window</span>
<span class="sd">        ends at the same datetime index will be predicted together.</span>
<span class="sd">    last_window : pandas DataFrame, default `None`</span>
<span class="sd">        Series values used to create the predictors (lags) needed in the </span>
<span class="sd">        first iteration of the prediction (t + 1).</span>
<span class="sd">        If `last_window = None`, the values stored in `self.last_window_` are</span>
<span class="sd">        used to calculate the initial predictors, and the predictions start</span>
<span class="sd">        right after training data.</span>
<span class="sd">    exog : pandas Series, pandas DataFrame, dict, default `None`</span>
<span class="sd">        Exogenous variable/s included as predictor/s.</span>
<span class="sd">    n_boot : int, default `250`</span>
<span class="sd">        Number of bootstrapping iterations used to estimate predictions.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random generator, so that boot predictions are always </span>
<span class="sd">        deterministic.</span>
<span class="sd">    use_in_sample_residuals : bool, default `True`</span>
<span class="sd">        If `True`, residuals from the training data are used as proxy of</span>
<span class="sd">        prediction error to create predictions. If `False`, out of sample </span>
<span class="sd">        residuals are used. In the latter case, the user should have</span>
<span class="sd">        calculated and stored the residuals within the forecaster (see</span>
<span class="sd">        `set_out_sample_residuals()`).</span>
<span class="sd">    suppress_warnings : bool, default `False`</span>
<span class="sd">        If `True`, skforecast warnings will be suppressed during the prediction </span>
<span class="sd">        process. See skforecast.exceptions.warn_skforecast_categories for more</span>
<span class="sd">        information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions : pandas DataFrame</span>
<span class="sd">        Distribution parameters estimated for each step and level.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

    <span class="n">boot_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict_bootstrapping</span><span class="p">(</span>
                       <span class="n">steps</span>                   <span class="o">=</span> <span class="n">steps</span><span class="p">,</span>
                       <span class="n">levels</span>                  <span class="o">=</span> <span class="n">levels</span><span class="p">,</span>
                       <span class="n">last_window</span>             <span class="o">=</span> <span class="n">last_window</span><span class="p">,</span>
                       <span class="n">exog</span>                    <span class="o">=</span> <span class="n">exog</span><span class="p">,</span>
                       <span class="n">n_boot</span>                  <span class="o">=</span> <span class="n">n_boot</span><span class="p">,</span>
                       <span class="n">random_state</span>            <span class="o">=</span> <span class="n">random_state</span><span class="p">,</span>
                       <span class="n">use_in_sample_residuals</span> <span class="o">=</span> <span class="n">use_in_sample_residuals</span><span class="p">,</span>
                       <span class="n">suppress_warnings</span>       <span class="o">=</span> <span class="n">suppress_warnings</span>
                   <span class="p">)</span>

    <span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">distribution</span><span class="o">.</span><span class="n">_pdf</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">p</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span>
    <span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span><span class="p">]</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">boot_samples</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">param_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">distribution</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">arr</span><span class="o">=</span><span class="n">boot_samples</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">level_param_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">param_names</span><span class="p">]</span>

        <span class="n">pred_level</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                         <span class="n">data</span>    <span class="o">=</span> <span class="n">param_values</span><span class="p">,</span>
                         <span class="n">columns</span> <span class="o">=</span> <span class="n">level_param_names</span><span class="p">,</span>
                         <span class="n">index</span>   <span class="o">=</span> <span class="n">boot_samples</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
                     <span class="p">)</span>

        <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred_level</span><span class="p">)</span>

    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">set_skforecast_warnings</span><span class="p">(</span><span class="n">suppress_warnings</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_params" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_params</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_params" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">set_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set new values to the parameters of the scikit learn model stored in the
forecaster.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>params</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameters values.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2658</span>
<span class="normal">2659</span>
<span class="normal">2660</span>
<span class="normal">2661</span>
<span class="normal">2662</span>
<span class="normal">2663</span>
<span class="normal">2664</span>
<span class="normal">2665</span>
<span class="normal">2666</span>
<span class="normal">2667</span>
<span class="normal">2668</span>
<span class="normal">2669</span>
<span class="normal">2670</span>
<span class="normal">2671</span>
<span class="normal">2672</span>
<span class="normal">2673</span>
<span class="normal">2674</span>
<span class="normal">2675</span>
<span class="normal">2676</span>
<span class="normal">2677</span>
<span class="normal">2678</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_params</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set new values to the parameters of the scikit learn model stored in the</span>
<span class="sd">    forecaster.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params : dict</span>
<span class="sd">        Parameters values.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span> <span class="o">=</span> <span class="n">clone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_fit_kwargs" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_fit_kwargs</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_fit_kwargs" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">set_fit_kwargs</span><span class="p">(</span><span class="n">fit_kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set new values for the additional keyword arguments passed to the <code>fit</code> 
method of the regressor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>fit_kwargs</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict of the form {"argument": new_value}.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2680</span>
<span class="normal">2681</span>
<span class="normal">2682</span>
<span class="normal">2683</span>
<span class="normal">2684</span>
<span class="normal">2685</span>
<span class="normal">2686</span>
<span class="normal">2687</span>
<span class="normal">2688</span>
<span class="normal">2689</span>
<span class="normal">2690</span>
<span class="normal">2691</span>
<span class="normal">2692</span>
<span class="normal">2693</span>
<span class="normal">2694</span>
<span class="normal">2695</span>
<span class="normal">2696</span>
<span class="normal">2697</span>
<span class="normal">2698</span>
<span class="normal">2699</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_fit_kwargs</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">fit_kwargs</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set new values for the additional keyword arguments passed to the `fit` </span>
<span class="sd">    method of the regressor.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fit_kwargs : dict</span>
<span class="sd">        Dict of the form {&quot;argument&quot;: new_value}.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fit_kwargs</span> <span class="o">=</span> <span class="n">check_select_fit_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="p">,</span> <span class="n">fit_kwargs</span><span class="o">=</span><span class="n">fit_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_lags" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_lags</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_lags" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">set_lags</span><span class="p">(</span><span class="n">lags</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set new value to the attribute <code>lags</code>. Attributes <code>lags_names</code>, 
<code>max_lag</code> and <code>window_size</code> are also updated.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>lags</code></td>
            <td>
                  <code>int, list, numpy ndarray, range</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lags used as predictors. Index starts at 1, so lag 1 is equal to t-1. </p>
<ul>
<li><code>int</code>: include lags from 1 to <code>lags</code> (included).</li>
<li><code>list</code>, <code>1d numpy ndarray</code> or <code>range</code>: include only lags present in 
<code>lags</code>, all elements must be int.</li>
<li><code>None</code>: no lags are included as predictors.</li>
</ul>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2701</span>
<span class="normal">2702</span>
<span class="normal">2703</span>
<span class="normal">2704</span>
<span class="normal">2705</span>
<span class="normal">2706</span>
<span class="normal">2707</span>
<span class="normal">2708</span>
<span class="normal">2709</span>
<span class="normal">2710</span>
<span class="normal">2711</span>
<span class="normal">2712</span>
<span class="normal">2713</span>
<span class="normal">2714</span>
<span class="normal">2715</span>
<span class="normal">2716</span>
<span class="normal">2717</span>
<span class="normal">2718</span>
<span class="normal">2719</span>
<span class="normal">2720</span>
<span class="normal">2721</span>
<span class="normal">2722</span>
<span class="normal">2723</span>
<span class="normal">2724</span>
<span class="normal">2725</span>
<span class="normal">2726</span>
<span class="normal">2727</span>
<span class="normal">2728</span>
<span class="normal">2729</span>
<span class="normal">2730</span>
<span class="normal">2731</span>
<span class="normal">2732</span>
<span class="normal">2733</span>
<span class="normal">2734</span>
<span class="normal">2735</span>
<span class="normal">2736</span>
<span class="normal">2737</span>
<span class="normal">2738</span>
<span class="normal">2739</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_lags</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">lags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">range</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set new value to the attribute `lags`. Attributes `lags_names`, </span>
<span class="sd">    `max_lag` and `window_size` are also updated.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lags : int, list, numpy ndarray, range, default `None`</span>
<span class="sd">        Lags used as predictors. Index starts at 1, so lag 1 is equal to t-1. </span>

<span class="sd">        - `int`: include lags from 1 to `lags` (included).</span>
<span class="sd">        - `list`, `1d numpy ndarray` or `range`: include only lags present in </span>
<span class="sd">        `lags`, all elements must be int.</span>
<span class="sd">        - `None`: no lags are included as predictors. </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">lags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;At least one of the arguments `lags` or `window_features` &quot;</span>
            <span class="s2">&quot;must be different from None. This is required to create the &quot;</span>
            <span class="s2">&quot;predictors used in training the forecaster.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span> <span class="o">=</span> <span class="n">initialize_lags</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">lags</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
        <span class="p">[</span><span class="n">ws</span> <span class="k">for</span> <span class="n">ws</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span><span class="p">]</span> 
         <span class="k">if</span> <span class="n">ws</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_window_features" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_window_features</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_window_features" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">set_window_features</span><span class="p">(</span><span class="n">window_features</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set new value to the attribute <code>window_features</code>. Attributes 
<code>max_size_window_features</code>, <code>window_features_names</code>, 
<code>window_features_class_names</code> and <code>window_size</code> are also updated.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>window_features</code></td>
            <td>
                  <code>(<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#object">object</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#list">list</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instance or list of instances used to create window features. Window features
are created from the original time series and are included as predictors.</p>
              </div>
            </td>
            <td>
                  <code>`None`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2741</span>
<span class="normal">2742</span>
<span class="normal">2743</span>
<span class="normal">2744</span>
<span class="normal">2745</span>
<span class="normal">2746</span>
<span class="normal">2747</span>
<span class="normal">2748</span>
<span class="normal">2749</span>
<span class="normal">2750</span>
<span class="normal">2751</span>
<span class="normal">2752</span>
<span class="normal">2753</span>
<span class="normal">2754</span>
<span class="normal">2755</span>
<span class="normal">2756</span>
<span class="normal">2757</span>
<span class="normal">2758</span>
<span class="normal">2759</span>
<span class="normal">2760</span>
<span class="normal">2761</span>
<span class="normal">2762</span>
<span class="normal">2763</span>
<span class="normal">2764</span>
<span class="normal">2765</span>
<span class="normal">2766</span>
<span class="normal">2767</span>
<span class="normal">2768</span>
<span class="normal">2769</span>
<span class="normal">2770</span>
<span class="normal">2771</span>
<span class="normal">2772</span>
<span class="normal">2773</span>
<span class="normal">2774</span>
<span class="normal">2775</span>
<span class="normal">2776</span>
<span class="normal">2777</span>
<span class="normal">2778</span>
<span class="normal">2779</span>
<span class="normal">2780</span>
<span class="normal">2781</span>
<span class="normal">2782</span>
<span class="normal">2783</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_window_features</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">window_features</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">object</span><span class="p">,</span> <span class="nb">list</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set new value to the attribute `window_features`. Attributes </span>
<span class="sd">    `max_size_window_features`, `window_features_names`, </span>
<span class="sd">    `window_features_class_names` and `window_size` are also updated.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    window_features : object, list, default `None`</span>
<span class="sd">        Instance or list of instances used to create window features. Window features</span>
<span class="sd">        are created from the original time series and are included as predictors.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">window_features</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;At least one of the arguments `lags` or `window_features` &quot;</span>
            <span class="s2">&quot;must be different from None. This is required to create the &quot;</span>
            <span class="s2">&quot;predictors used in training the forecaster.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features_names</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">initialize_window_features</span><span class="p">(</span><span class="n">window_features</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">window_features_class_names</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">window_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_features_class_names</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">type</span><span class="p">(</span><span class="n">wf</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">wf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_features</span>
        <span class="p">]</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
        <span class="p">[</span><span class="n">ws</span> <span class="k">for</span> <span class="n">ws</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">max_lag</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_size_window_features</span><span class="p">]</span> 
         <span class="k">if</span> <span class="n">ws</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_size</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window_size</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_out_sample_residuals" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">set_out_sample_residuals</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.set_out_sample_residuals" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">set_out_sample_residuals</span><span class="p">(</span>
    <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set new values to the attribute <code>out_sample_residuals_</code>. Out of sample
residuals are meant to be calculated using observations that did not
participate in the training process. <code>y_true</code> and <code>y_pred</code> are expected
to be in the original scale of the time series. Residuals are calculated
as <code>y_true</code> - <code>y_pred</code>, after applying the necessary transformations and
differentiations if the forecaster includes them (<code>self.transformer_series</code>
and <code>self.differentiation</code>).</p>
<p>A total of 10_000 residuals are stored in the attribute <code>out_sample_residuals_</code>.
If the number of residuals is greater than 10_000, a random sample of
10_000 residuals is stored.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>y_true</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of numpy ndarrays or pandas series with the true values of
the time series for each series in the form {series: y_true}.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>y_pred</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of numpy ndarrays or pandas series with the predicted values
of the time series for each series in the form {series: y_pred}.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>append</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, new residuals are added to the once already stored in the
attribute <code>out_sample_residuals_</code>. If after appending the new residuals,
the limit of 10_000 samples is exceeded, a random sample of 10_000 is
kept.</p>
              </div>
            </td>
            <td>
                  <code>`False`</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>random_state</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sets a seed to the random sampling for reproducible output.</p>
              </div>
            </td>
            <td>
                  <code>`123`</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2785</span>
<span class="normal">2786</span>
<span class="normal">2787</span>
<span class="normal">2788</span>
<span class="normal">2789</span>
<span class="normal">2790</span>
<span class="normal">2791</span>
<span class="normal">2792</span>
<span class="normal">2793</span>
<span class="normal">2794</span>
<span class="normal">2795</span>
<span class="normal">2796</span>
<span class="normal">2797</span>
<span class="normal">2798</span>
<span class="normal">2799</span>
<span class="normal">2800</span>
<span class="normal">2801</span>
<span class="normal">2802</span>
<span class="normal">2803</span>
<span class="normal">2804</span>
<span class="normal">2805</span>
<span class="normal">2806</span>
<span class="normal">2807</span>
<span class="normal">2808</span>
<span class="normal">2809</span>
<span class="normal">2810</span>
<span class="normal">2811</span>
<span class="normal">2812</span>
<span class="normal">2813</span>
<span class="normal">2814</span>
<span class="normal">2815</span>
<span class="normal">2816</span>
<span class="normal">2817</span>
<span class="normal">2818</span>
<span class="normal">2819</span>
<span class="normal">2820</span>
<span class="normal">2821</span>
<span class="normal">2822</span>
<span class="normal">2823</span>
<span class="normal">2824</span>
<span class="normal">2825</span>
<span class="normal">2826</span>
<span class="normal">2827</span>
<span class="normal">2828</span>
<span class="normal">2829</span>
<span class="normal">2830</span>
<span class="normal">2831</span>
<span class="normal">2832</span>
<span class="normal">2833</span>
<span class="normal">2834</span>
<span class="normal">2835</span>
<span class="normal">2836</span>
<span class="normal">2837</span>
<span class="normal">2838</span>
<span class="normal">2839</span>
<span class="normal">2840</span>
<span class="normal">2841</span>
<span class="normal">2842</span>
<span class="normal">2843</span>
<span class="normal">2844</span>
<span class="normal">2845</span>
<span class="normal">2846</span>
<span class="normal">2847</span>
<span class="normal">2848</span>
<span class="normal">2849</span>
<span class="normal">2850</span>
<span class="normal">2851</span>
<span class="normal">2852</span>
<span class="normal">2853</span>
<span class="normal">2854</span>
<span class="normal">2855</span>
<span class="normal">2856</span>
<span class="normal">2857</span>
<span class="normal">2858</span>
<span class="normal">2859</span>
<span class="normal">2860</span>
<span class="normal">2861</span>
<span class="normal">2862</span>
<span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span>
<span class="normal">2866</span>
<span class="normal">2867</span>
<span class="normal">2868</span>
<span class="normal">2869</span>
<span class="normal">2870</span>
<span class="normal">2871</span>
<span class="normal">2872</span>
<span class="normal">2873</span>
<span class="normal">2874</span>
<span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span>
<span class="normal">2878</span>
<span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span>
<span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span>
<span class="normal">2909</span>
<span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_out_sample_residuals</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">y_true</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">y_pred</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">append</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set new values to the attribute `out_sample_residuals_`. Out of sample</span>
<span class="sd">    residuals are meant to be calculated using observations that did not</span>
<span class="sd">    participate in the training process. `y_true` and `y_pred` are expected</span>
<span class="sd">    to be in the original scale of the time series. Residuals are calculated</span>
<span class="sd">    as `y_true` - `y_pred`, after applying the necessary transformations and</span>
<span class="sd">    differentiations if the forecaster includes them (`self.transformer_series`</span>
<span class="sd">    and `self.differentiation`).</span>

<span class="sd">    A total of 10_000 residuals are stored in the attribute `out_sample_residuals_`.</span>
<span class="sd">    If the number of residuals is greater than 10_000, a random sample of</span>
<span class="sd">    10_000 residuals is stored.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y_true : dict</span>
<span class="sd">        Dictionary of numpy ndarrays or pandas series with the true values of</span>
<span class="sd">        the time series for each series in the form {series: y_true}.</span>
<span class="sd">    y_pred : dict</span>
<span class="sd">        Dictionary of numpy ndarrays or pandas series with the predicted values</span>
<span class="sd">        of the time series for each series in the form {series: y_pred}.</span>
<span class="sd">    append : bool, default `False`</span>
<span class="sd">        If `True`, new residuals are added to the once already stored in the</span>
<span class="sd">        attribute `out_sample_residuals_`. If after appending the new residuals,</span>
<span class="sd">        the limit of 10_000 samples is exceeded, a random sample of 10_000 is</span>
<span class="sd">        kept.</span>
<span class="sd">    random_state : int, default `123`</span>
<span class="sd">        Sets a seed to the random sampling for reproducible output.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
            <span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
            <span class="s2">&quot;arguments before using `set_out_sample_residuals()`.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`y_true` must be a dictionary of numpy ndarrays or pandas Series. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`y_pred` must be a dictionary of numpy ndarrays or pandas Series. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`y_true` and `y_pred` must have the same keys. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">y_true</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">set</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">y_true</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Values of `y_true` must be numpy ndarrays or pandas Series. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="si">}</span><span class="s2"> for series &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Values of `y_pred` must be numpy ndarrays or pandas Series. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="si">}</span><span class="s2"> for series &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`y_true` and `y_pred` must have the same length. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="si">}</span><span class="s2"> for series &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;When containing pandas Series, elements in `y_true` and &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;`y_pred` must have the same index. Error with series &#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
                <span class="p">)</span>

    <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series_names_in_</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="o">=</span> <span class="p">{</span><span class="n">level</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">}</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>

    <span class="n">series_to_update</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">y_pred</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">levels</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">series_to_update</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Provided keys in `y_pred` and `y_true` do not match any series &quot;</span>
            <span class="s2">&quot;seen during `fit`. Residuals cannot be updated.&quot;</span>
        <span class="p">)</span>

    <span class="n">residuals</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">y_true</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">differentiator</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiator</span><span class="p">)</span>
        <span class="n">differentiator</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">series_to_update</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series</span><span class="p">:</span>
            <span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
                            <span class="n">array</span>             <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                            <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                            <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="p">)</span>
            <span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">transform_numpy</span><span class="p">(</span>
                            <span class="n">array</span>             <span class="o">=</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                            <span class="n">transformer</span>       <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transformer_series_</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                            <span class="n">fit</span>               <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="n">inverse_transform</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">])[</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="p">:]</span>
            <span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">differentiator</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">])[</span><span class="bp">self</span><span class="o">.</span><span class="n">differentiation</span><span class="p">:]</span>

        <span class="n">residuals</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

    <span class="k">if</span> <span class="s1">&#39;_unknown_level&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">residuals</span><span class="p">:</span>
        <span class="n">residuals</span><span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">residuals</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">residuals</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">!=</span> <span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;As `encoding` is set to `None`, no distinction between levels &quot;</span>
                <span class="s2">&quot;is made. All residuals are stored in the &#39;_unknown_level&#39; key.&quot;</span><span class="p">,</span>
                <span class="n">UnknownLevelWarning</span>
            <span class="p">)</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">:</span> <span class="n">residuals</span><span class="p">[</span><span class="s1">&#39;_unknown_level&#39;</span><span class="p">]}</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">residuals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">append</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span><span class="p">[</span><span class="n">key</span><span class="p">],</span>
                        <span class="n">value</span>
                    <span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_sample_residuals_</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.get_feature_importances" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">get_feature_importances</span>


<a href="#skforecast.recursive._forecaster_recursive_multiseries.ForecasterRecursiveMultiSeries.get_feature_importances" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="language-python doc-signature highlight"><pre><span></span><code><span class="nf">get_feature_importances</span><span class="p">(</span><span class="n">sort_importance</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return feature importances of the regressor stored in the
forecaster. Only valid when regressor stores internally the feature
importances in the attribute <code>feature_importances_</code> or <code>coef_</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>sort_importance</code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>True</code>, sorts the feature importances in descending order.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>feature_importances</code></td>            <td>
                  <code>pandas DataFrame</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Feature importances associated with each predictor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>skforecast/recursive/_forecaster_recursive_multiseries.py</code></summary>
              <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span>
<span class="normal">2954</span>
<span class="normal">2955</span>
<span class="normal">2956</span>
<span class="normal">2957</span>
<span class="normal">2958</span>
<span class="normal">2959</span>
<span class="normal">2960</span>
<span class="normal">2961</span>
<span class="normal">2962</span>
<span class="normal">2963</span>
<span class="normal">2964</span>
<span class="normal">2965</span>
<span class="normal">2966</span>
<span class="normal">2967</span>
<span class="normal">2968</span>
<span class="normal">2969</span>
<span class="normal">2970</span>
<span class="normal">2971</span>
<span class="normal">2972</span>
<span class="normal">2973</span>
<span class="normal">2974</span>
<span class="normal">2975</span>
<span class="normal">2976</span>
<span class="normal">2977</span>
<span class="normal">2978</span>
<span class="normal">2979</span>
<span class="normal">2980</span>
<span class="normal">2981</span>
<span class="normal">2982</span>
<span class="normal">2983</span>
<span class="normal">2984</span>
<span class="normal">2985</span>
<span class="normal">2986</span>
<span class="normal">2987</span>
<span class="normal">2988</span>
<span class="normal">2989</span>
<span class="normal">2990</span>
<span class="normal">2991</span>
<span class="normal">2992</span>
<span class="normal">2993</span>
<span class="normal">2994</span>
<span class="normal">2995</span>
<span class="normal">2996</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_feature_importances</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">sort_importance</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return feature importances of the regressor stored in the</span>
<span class="sd">    forecaster. Only valid when regressor stores internally the feature</span>
<span class="sd">    importances in the attribute `feature_importances_` or `coef_`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sort_importance: bool, default `True`</span>
<span class="sd">        If `True`, sorts the feature importances in descending order.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    feature_importances : pandas DataFrame</span>
<span class="sd">        Feature importances associated with each predictor.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_fitted</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFittedError</span><span class="p">(</span>
            <span class="p">(</span><span class="s2">&quot;This forecaster is not fitted yet. Call `fit` with appropriate &quot;</span>
             <span class="s2">&quot;arguments before using `get_feature_importances()`.&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="p">,</span> <span class="n">Pipeline</span><span class="p">):</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regressor</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="s1">&#39;feature_importances_&#39;</span><span class="p">):</span>
        <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">feature_importances_</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="s1">&#39;coef_&#39;</span><span class="p">):</span>
        <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">coef_</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Impossible to access feature importances for regressor of type &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">estimator</span><span class="p">)</span><span class="si">}</span><span class="s2">. This method is only valid when the &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;regressor stores internally the feature importances in the &quot;</span>
             <span class="sa">f</span><span class="s2">&quot;attribute `feature_importances_` or `coef_`.&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">feature_importances</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">feature_importances</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                                  <span class="s1">&#39;feature&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">X_train_features_names_out_</span><span class="p">,</span>
                                  <span class="s1">&#39;importance&#39;</span><span class="p">:</span> <span class="n">feature_importances</span>
                              <span class="p">})</span>
        <span class="k">if</span> <span class="n">sort_importance</span><span class="p">:</span>
            <span class="n">feature_importances</span> <span class="o">=</span> <span class="n">feature_importances</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
                                      <span class="n">by</span><span class="o">=</span><span class="s1">&#39;importance&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span>
                                  <span class="p">)</span>

    <span class="k">return</span> <span class="n">feature_importances</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2024 Joaquín Amat Rodrigo, Javier Escobar Ortiz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/skforecast/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "toc.integrate", "navigation.breadcrumbs"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>